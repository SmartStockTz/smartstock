(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{eUy1:function(t,e,o){"use strict";o.d(e,"a",(function(){return d}));var n=o("6nr9"),a=o("HUVf"),r=o("G3K4"),i=o("n90K"),c=o("TYT/"),s=o("cUzu"),l=function(t,e,o,n){return new(o||(o=Promise))((function(a,r){function i(t){try{s(n.next(t))}catch(e){r(e)}}function c(t){try{s(n.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(i,c)}s((n=n.apply(t,e||[])).next())}))},u=function(t,e){var o,n,a,r,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;i;)try{if(o=1,n&&(a=2&r[0]?n.return:r[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,r[1])).done)return a;switch(n=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,n=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==r[0]&&2!==r[0])){i=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){i.label=r[1];break}if(6===r[0]&&i.label<a[1]){i.label=a[1],a=r;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(r);break}a[2]&&i.ops.pop(),i.trys.pop();continue}r=e.call(t,i)}catch(c){r=[6,c],n=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}},d=function(){function t(t,e,o,n){this._httpClient=t,this._user=e,this._storage=o,this._settings=n}return t.prototype.exportToExcel=function(){return l(this,void 0,void 0,(function(){var t,e,o;return u(this,(function(n){switch(n.label){case 0:return[4,this._user.currentUser()];case 1:return t=n.sent(),[4,this._settings.getCustomerProjectId()];case 2:return e=n.sent(),o=encodeURIComponent(t.email),[2,r.BFast.functions(e).request(this._settings.ssmFunctionsURL+"/functions/stocks/export/"+e+"/"+o).get({})]}}))}))},t.prototype.addAllCategory=function(t,e){},t.prototype.importStocks=function(t){return l(this,void 0,void 0,(function(){var e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=o.sent(),[2,r.BFast.functions(e.projectId).request(this._settings.ssmFunctionsURL+"/functions/stocks/import/"+e.projectId).post(t,this._settings.ssmFunctionsHeader)]}}))}))},t.prototype.addAllSupplier=function(t,e){},t.prototype.addCategory=function(t){return l(this,void 0,void 0,(function(){var e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=o.sent(),[2,r.BFast.database(e.projectId).collection("categories").save(t)]}}))}))},t.prototype.addUnit=function(t){return l(this,void 0,void 0,(function(){var e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=o.sent(),[2,r.BFast.database(e.projectId).collection("units").save(t)]}}))}))},t.prototype.getAllUnit=function(t){return l(this,void 0,void 0,(function(){var t,e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return t=o.sent(),[4,r.BFast.database(t.projectId).collection("units").getAll()];case 2:return(e=o.sent()).sort((function(t,e){return new Date(e.updatedAt).getTime()-new Date(t.updatedAt).getTime()})),[2,e]}}))}))},t.prototype.addStock=function(t){return l(this,void 0,void 0,(function(){var e,o,n,a,i,c;return u(this,(function(s){switch(s.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=s.sent(),t.image?[4,r.BFast.storage(e.projectId).save({fileName:"product.png",data:{base64:t.image},fileType:null})]:[3,3];case 2:o=s.sent(),t.image=o.url,s.label=3;case 3:if(!(t.downloads&&t.downloads.length>0))return[3,7];n=0,a=t.downloads,s.label=4;case 4:return n<a.length?(i=a[n],[4,r.BFast.storage(e.projectId).save({fileName:"downloadableFile."+i.name.split(".").pop(),data:{base64:i.url},fileType:i.type})]):[3,7];case 5:c=s.sent(),i.url=c.url,s.label=6;case 6:return n++,[3,4];case 7:return[2,r.BFast.database(e.projectId).collection("stocks").save(t)]}}))}))},t.prototype.addSupplier=function(t){return l(this,void 0,void 0,(function(){var e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=o.sent(),[2,r.BFast.database(e.projectId).collection("suppliers").save(t)]}}))}))},t.prototype.deleteAllCategory=function(t,e){},t.prototype.deleteAllStock=function(t,e){},t.prototype.deleteAllSupplier=function(t,e){},t.prototype.deleteCategory=function(t){return l(this,void 0,void 0,(function(){var e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=o.sent(),[2,r.BFast.database(e.projectId).collection("categories").delete(t.objectId)]}}))}))},t.prototype.deleteStock=function(t){return l(this,void 0,void 0,(function(){var e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=o.sent(),[2,r.BFast.database(e.projectId).collection("stocks").delete(t._id?t._id:t.objectId)]}}))}))},t.prototype.deleteSupplier=function(t){return l(this,void 0,void 0,(function(){var e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=o.sent(),[2,r.BFast.database(e.projectId).collection("suppliers").delete(t)]}}))}))},t.prototype.getAllCategory=function(t){return l(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return[4,this._storage.getActiveShop()];case 1:return t=e.sent(),[2,r.BFast.database(t.projectId).collection("categories").getAll(null,{cacheEnable:!0,dtl:7,freshDataCallback:function(t){}})]}}))}))},t.prototype.getAllStock=function(){return l(this,void 0,void 0,(function(){var t,e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return t=o.sent(),[4,r.BFast.database(t.projectId).collection("stocks").getAll(void 0,{cacheEnable:!1,dtl:0})];case 2:return e=o.sent(),[4,this._storage.saveStocks(e)];case 3:return o.sent(),[2,e]}}))}))},t.prototype.getAllSupplier=function(t){return l(this,void 0,void 0,(function(){var t,e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return t=o.sent(),[4,r.BFast.database(t.projectId).collection("suppliers").getAll()];case 2:return(e=o.sent()).sort((function(t,e){return new Date(e.updatedAt).getTime()-new Date(t.updatedAt).getTime()})),[2,e]}}))}))},t.prototype.getCategory=function(t,e){},t.prototype.getStock=function(t,e){return l(this,void 0,void 0,(function(){var e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=o.sent(),[2,r.BFast.database(e.projectId).collection("stocks").get(t,{cacheEnable:!1,dtl:0})]}}))}))},t.prototype.getSupplier=function(t,e){},t.prototype.updateAllCategory=function(t,e){},t.prototype.updateAllStock=function(t,e){},t.prototype.updateAllSupplier=function(t){},t.prototype.updateCategory=function(t){return l(this,void 0,void 0,(function(){var e,o,n,a;return u(this,(function(i){switch(i.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=i.sent(),o=t.objectId,(n={})[t.field]=t.value,delete t.objectId,[4,r.BFast.database(e.projectId).collection("categories").update(o,n)];case 2:return(a=i.sent()).objectId=o,[2,a]}}))}))},t.prototype.updateCategoryMobile=function(t,e){var o=this;return new Promise((function(n,a){return l(o,void 0,void 0,(function(){var o,r,i,c;return u(this,(function(s){switch(s.label){case 0:return r=(o=this._httpClient).put,[4,this._settings.getCustomerServerURL()];case 1:return i=[s.sent()+"/classes/categories-mobile-ui/"+e,t],c={},[4,this._settings.getCustomerPostHeader()];case 2:return r.apply(o,i.concat([(c.headers=s.sent(),c)])).subscribe((function(t){n(t)}),(function(t){a(t)})),[2]}}))}))}))},t.prototype.updateStock=function(t){return l(this,void 0,void 0,(function(){var e,o,n,a,i,c,s;return u(this,(function(l){switch(l.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=l.sent(),o=t._id?t._id:t.objectId,delete t.objectId,!t.image||t.image.toString().startsWith("http")?[3,3]:[4,r.BFast.storage(e.projectId).save({fileName:"product.png",data:{base64:t.image},fileType:null})];case 2:n=l.sent(),t.image=n.url,l.label=3;case 3:if(!(t.downloads&&t.downloads.length>0))return[3,7];a=0,i=t.downloads,l.label=4;case 4:return a<i.length?!(c=i[a])||c.url.startsWith("http")?[3,6]:[4,r.BFast.storage(e.projectId).save({fileName:"downloadableFile."+c.name.split(".").pop(),data:{base64:c.url},fileType:c.type})]:[3,7];case 5:s=l.sent(),c.url=s.url,l.label=6;case 6:return a++,[3,4];case 7:return[2,r.BFast.database(e.projectId).collection("stocks").update(o,t)]}}))}))},t.prototype.updateSupplier=function(t){return l(this,void 0,void 0,(function(){var e,o,n,a;return u(this,(function(i){switch(i.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=i.sent(),o=t.objectId,(n={})[t.field]=t.value,delete t.objectId,[4,r.BFast.database(e.projectId).collection("suppliers").update(o,n)];case 2:return(a=i.sent()).objectId=o,[2,a]}}))}))},t.prototype.updateUnit=function(t){return l(this,void 0,void 0,(function(){var e,o,n,a;return u(this,(function(i){switch(i.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=i.sent(),o=t.objectId,(n={})[t.field]=t.value,delete t.objectId,[4,r.BFast.database(e.projectId).collection("units").update(o,n)];case 2:return(a=i.sent()).objectId=o,[2,a]}}))}))},t.prototype.deleteUnit=function(t){return l(this,void 0,void 0,(function(){var e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=o.sent(),[2,r.BFast.database(e.projectId).collection("units").delete(t.objectId)]}}))}))},t.prototype.addPurchase=function(t){return l(this,void 0,void 0,(function(){var e;return u(this,(function(o){switch(o.label){case 0:return[4,this._storage.getActiveShop()];case 1:return e=o.sent(),[2,r.BFast.functions(e.projectId).request(this._settings.ssmFunctionsURL+"/functions/purchases/"+e.projectId).post(t,this._settings.ssmFunctionsHeader)]}}))}))},t.\u0275fac=function(e){return new(e||t)(c.Zb(s.a),c.Zb(a.a),c.Zb(i.a),c.Zb(n.a))},t.\u0275prov=c.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},fm87:function(t,e,o){"use strict";o.r(e),o.d(e,"ReportsModule",(function(){return Te}));var n,a=o("Valr"),r=o("DUip"),i=o("425f"),c=o("AytR"),s=o("TYT/"),l=o("xJ+t"),u=o("R/7W"),d=o("M1DL"),b=o("ETwC"),p=o("n90K"),f=o("nbAZ"),m=o("iXKo"),h=o("F/XL"),g=o("QJY3"),v=o("QN+r"),y=o("ZARc"),C=o("Byqp"),w=o("5msO"),D=o("17Os"),U=o("eHTH"),V=o("cSbt"),S=o("tNiZ"),k=o("agxM"),R=o("MqYC"),x=o("L3sc"),E=o("2J1J"),P=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});function T(t,e){if(1&t&&s.Qb(0,"app-data-not-ready",14),2&t){var o=s.hc();s.nc("isLoading",o.isLoading)}}function _(t,e){1&t&&(s.Vb(0,"th",29),s.Gc(1,"Product"),s.Ub())}function F(t,e){if(1&t&&(s.Vb(0,"td",30),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o._id)}}function I(t,e){1&t&&s.Qb(0,"td",31)}function G(t,e){1&t&&(s.Vb(0,"th",29),s.Gc(1,"Quantity sold"),s.Ub())}function j(t,e){if(1&t&&(s.Vb(0,"td",30),s.Gc(1),s.ic(2,"number"),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(s.jc(2,1,o.quantitySold))}}function Q(t,e){1&t&&s.Qb(0,"td",31)}function L(t,e){1&t&&(s.Vb(0,"th",29),s.Gc(1,"First sold"),s.Ub())}function O(t,e){if(1&t&&(s.Vb(0,"td",30),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o.firstSold)}}function A(t,e){1&t&&s.Qb(0,"td",31)}function B(t,e){1&t&&(s.Vb(0,"th",29),s.Gc(1,"Last sold"),s.Ub())}function H(t,e){if(1&t&&(s.Vb(0,"td",32),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o.lastSold)}}function M(t,e){1&t&&s.Qb(0,"td",31)}function $(t,e){1&t&&(s.Vb(0,"th",29),s.Gc(1,"Cost of goods sold"),s.Ub())}function z(t,e){if(1&t&&(s.Vb(0,"td",30),s.Gc(1),s.ic(2,"currency"),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(s.kc(2,1,o.costOfGoodsSold," TZS"))}}function q(t,e){1&t&&s.Qb(0,"td",31)}function J(t,e){1&t&&(s.Vb(0,"th",29),s.Gc(1,"Gross profit"),s.Ub())}function W(t,e){if(1&t&&(s.Vb(0,"td",30),s.Gc(1),s.ic(2,"currency"),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(s.kc(2,1,o.sales-o.costOfGoodsSold," TZS"))}}function N(t,e){1&t&&s.Qb(0,"td",31)}function Z(t,e){1&t&&s.Qb(0,"tr",33)}function Y(t,e){1&t&&s.Qb(0,"tr",34),2&t&&s.oc("matTooltip",e.$implicit.product)}function K(t,e){1&t&&s.Qb(0,"tr",35)}function X(t,e){if(1&t&&(s.Vb(0,"div"),s.Vb(1,"table",15),s.Tb(2,16),s.Ec(3,_,2,0,"th",17),s.Ec(4,F,2,1,"td",18),s.Ec(5,I,1,0,"td",19),s.Sb(),s.Tb(6,20),s.Ec(7,G,2,0,"th",17),s.Ec(8,j,3,3,"td",18),s.Ec(9,Q,1,0,"td",19),s.Sb(),s.Tb(10,21),s.Ec(11,L,2,0,"th",17),s.Ec(12,O,2,1,"td",18),s.Ec(13,A,1,0,"td",19),s.Sb(),s.Tb(14,22),s.Ec(15,B,2,0,"th",17),s.Ec(16,H,2,1,"td",23),s.Ec(17,M,1,0,"td",19),s.Sb(),s.Tb(18,24),s.Ec(19,$,2,0,"th",17),s.Ec(20,z,3,4,"td",18),s.Ec(21,q,1,0,"td",19),s.Sb(),s.Tb(22,25),s.Ec(23,J,2,0,"th",17),s.Ec(24,W,3,4,"td",18),s.Ec(25,N,1,0,"td",19),s.Sb(),s.Ec(26,Z,1,0,"tr",26),s.Ec(27,Y,1,1,"tr",27),s.Ec(28,K,1,0,"tr",28),s.Ub(),s.Ub()),2&t){var o=s.hc();s.Cb(1),s.nc("dataSource",o.productPerformanceDatasource),s.Cb(25),s.nc("matHeaderRowDef",o.stockColumns),s.Cb(1),s.nc("matRowDefColumns",o.stockColumns),s.Cb(1),s.nc("matFooterRowDef",o.stockColumns)}}var tt=function(){return[10,20,100]},et=function(t){function e(e,o,n,a,r){var i=t.call(this)||this;return i.router=e,i.indexDb=o,i.snack=n,i.logger=a,i._report=r,i.productPerformanceFetchProgress=!1,i.startDateFormControl=new g.g("",[g.F.nullValidator]),i.endDateFormControl=new g.g("",[g.F.nullValidator]),i.channelFormControl=new g.g("",[g.F.nullValidator]),i.channel="retail",i.isLoading=!1,i.noDataRetrieved=!0,i.hotReloadProgress=!1,i.totalPurchase=Object(h.a)(0),i.stockColumns=["product","quantitySold","firstSold","lastSold","costOfGoodSold","grossProfit"],i}return P(e,t),e.prototype.ngOnInit=function(){this.channelFormControl.setValue("retail"),this.startDate=Object(y.a)(new Date),this.endDate=Object(y.a)(new Date),this._getProductReport(this.channel,this.startDate,this.endDate),this._dateRangeListener()},e.prototype._getProductReport=function(t,e,o){var n=this;this.isLoading=!0,this.productPerformanceFetchProgress=!0,console.log("from: "+e+" to: "+o),this._report.getProductPerformanceReport(t,e,o).then((function(t){n.isLoading=!1,n.noDataRetrieved=!1,n.productPerformanceReport=t.length>0?t[0].total:0,n.productPerformanceDatasource=new b.o(t),n.productPerformanceDatasource.paginator=n.paginator,n.productPerformanceDatasource.sort=n.sort,n.productPerformanceFetchProgress=!1})).catch((function(t){n.isLoading=!1,n.noDataRetrieved=!0,n.productPerformanceReport=0,n.snack.open("Fails to get product performance report","Ok",{duration:3e3}),n.productPerformanceFetchProgress=!1}))},e.prototype._dateRangeListener=function(){var t=this;this.startDateFormControl.valueChanges.subscribe((function(e){t.startDate=Object(y.a)(e),t._getProductReport(t.channel,t.startDate,t.endDate)})),this.endDateFormControl.valueChanges.subscribe((function(e){t.endDate=Object(y.a)(e),t._getProductReport(t.channel,t.startDate,t.endDate)})),this.channelFormControl.valueChanges.subscribe((function(e){t.channel=e,t._getProductReport(t.channel,t.startDate,t.endDate)}))},e.\u0275fac=function(t){return new(t||e)(s.Pb(r.b),s.Pb(p.a),s.Pb(w.a),s.Pb(m.a),s.Pb(v.a))},e.\u0275cmp=s.Jb({type:e,selectors:[["app-product-performance-report"]],viewQuery:function(t,e){var o;1&t&&(s.Cc(f.a,!0),s.Cc(C.a,!0)),2&t&&(s.sc(o=s.ec())&&(e.paginator=o.first),s.sc(o=s.ec())&&(e.sort=o.first))},features:[s.Bb([v.a]),s.zb],decls:32,vars:11,consts:[[1,"col-12"],[1,"mat-elevation-z3"],[2,"margin","0 4px"],["matInput","",3,"matDatepicker","formControl","click"],["matSuffix","",3,"for"],["startDatePicker",""],["endDatePicker",""],[2,"flex-grow","1"],[3,"formControl"],["value","retail"],["value","whole"],[3,"isLoading",4,"ngIf"],[4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],[3,"isLoading"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","quantitySold"],["matColumnDef","firstSold"],["matColumnDef","lastSold"],["matRipple","","mat-cell","",4,"matCellDef"],["matColumnDef","costOfGoodSold"],["matColumnDef","grossProfit"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","style","font-size: 36px",4,"matFooterRowDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell",""],["matRipple","","mat-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"],["mat-footer-row","",2,"font-size","36px"]],template:function(t,e){if(1&t){var o=s.Wb();s.Vb(0,"div",0),s.Vb(1,"div"),s.Vb(2,"mat-card",1),s.Vb(3,"h6"),s.Gc(4,"Product Performance Report"),s.Ub(),s.Vb(5,"mat-card-header"),s.Vb(6,"mat-form-field",2),s.Vb(7,"mat-label"),s.Gc(8,"From date"),s.Ub(),s.Vb(9,"input",3),s.dc("click",(function(){return s.xc(o),s.tc(12).open()})),s.Ub(),s.Qb(10,"mat-datepicker-toggle",4),s.Qb(11,"mat-datepicker",null,5),s.Ub(),s.Vb(13,"mat-form-field",2),s.Vb(14,"mat-label"),s.Gc(15,"To date"),s.Ub(),s.Vb(16,"input",3),s.dc("click",(function(){return s.xc(o),s.tc(19).open()})),s.Ub(),s.Qb(17,"mat-datepicker-toggle",4),s.Qb(18,"mat-datepicker",null,6),s.Ub(),s.Qb(20,"span",7),s.Vb(21,"mat-form-field"),s.Vb(22,"mat-label"),s.Gc(23,"Sales type"),s.Ub(),s.Vb(24,"mat-select",8),s.Vb(25,"mat-option",9),s.Gc(26,"Retail"),s.Ub(),s.Vb(27,"mat-option",10),s.Gc(28,"Whole sale"),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ec(29,T,1,1,"app-data-not-ready",11),s.Ec(30,X,29,4,"div",12),s.Qb(31,"mat-paginator",13),s.Ub(),s.Ub(),s.Ub()}if(2&t){var n=s.tc(12),a=s.tc(19);s.Cb(9),s.nc("matDatepicker",n)("formControl",e.startDateFormControl),s.Cb(1),s.nc("for",n),s.Cb(6),s.nc("matDatepicker",a)("formControl",e.endDateFormControl),s.Cb(1),s.nc("for",a),s.Cb(7),s.nc("formControl",e.channelFormControl),s.Cb(5),s.nc("ngIf",e.noDataRetrieved||e.isLoading),s.Cb(1),s.nc("ngIf",!e.noDataRetrieved&&!e.isLoading),s.Cb(1),s.nc("pageSizeOptions",s.pc(10,tt))}},directives:[D.a,D.f,U.b,U.f,V.b,S.f,g.c,g.r,g.h,S.h,U.i,S.d,k.a,R.n,a.t,f.a,x.a,b.n,C.a,b.c,b.i,b.b,b.e,b.k,b.m,b.g,b.h,C.b,b.a,b.d,b.j,b.l,E.a,b.f],pipes:[a.g,a.d],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),e}(i.a),ot=o("6n/F"),nt=o("p+mS"),at=o("GsDI"),rt=o("uad8");function it(t,e){1&t&&(s.Vb(0,"mat-icon"),s.Gc(1,"refresh"),s.Ub())}function ct(t,e){1&t&&s.Qb(0,"mat-progress-spinner",18),2&t&&s.nc("diameter",15)}function st(t,e){if(1&t&&s.Qb(0,"app-data-not-ready",19),2&t){var o=s.hc();s.nc("isLoading",o.isLoading)}}var lt=function(){function t(t){this._report=t,this.salesTrendDayFromDateFormControl=new g.g,this.salesTrendDayToDateFormControl=new g.g,this.salesByDayTrendProgress=!1,this.trendChart=void 0,this.isLoading=!1,this.noDataRetrieved=!0}return t.prototype.ngOnInit=function(){var t=new Date,e=new Date((new Date).setDate(t.getDate()-7));this.salesTrendDayFromDateFormControl.setValue(e),this.salesTrendDayToDateFormControl.setValue(t),this._getSalesTrend(Object(y.a)(e),Object(y.a)(t)),this._listenForDateChange()},t.prototype._listenForDateChange=function(){var t=this;this.salesTrendDayFromDateFormControl.valueChanges.subscribe((function(e){t.refreshTrendReport()})),this.salesTrendDayToDateFormControl.valueChanges.subscribe((function(e){t.refreshTrendReport()}))},t.prototype._getSalesTrend=function(t,e){var o=this;this.isLoading=!0,this.salesByDayTrendProgress=!0,this._report.getSalesTrend(t,e).then((function(t){o.isLoading=!1,o.noDataRetrieved=!1,o.initiateGraph(t),o.salesByDayTrendProgress=!1})).catch((function(t){o.isLoading=!1,o.noDataRetrieved=!0,o.salesByDayTrendProgress=!1}))},t.prototype.initiateGraph=function(t){var e=[],o=[];Object.keys(t).forEach((function(n){e.push(t[n]._id),o.push(t[n].total)})),this.trendChart=ot.chart("salesTrendByDay",{chart:{type:"areaspline"},title:{text:"Sales By Date"},xAxis:{categories:e,title:{text:"Day"},labels:{formatter:function(){return this.value}}},yAxis:{title:{text:"Total Sales"},labels:{formatter:function(){return this.value}}},tooltip:{},plotOptions:{area:{marker:{enabled:!1,symbol:"circle",radius:4,states:{hover:{enabled:!0}}}}},series:[{name:"Sales",color:"#0b2e13",data:o}]})},t.prototype.refreshTrendReport=function(){this._getSalesTrend(Object(y.a)(new Date(this.salesTrendDayFromDateFormControl.value)),Object(y.a)(new Date(this.salesTrendDayToDateFormControl.value)))},t.\u0275fac=function(e){return new(e||t)(s.Pb(v.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-dashboard-sale-trends"]],features:[s.Bb([v.a])],decls:29,vars:12,consts:[[1,"col-12",2,"margin-top","1em"],[1,"mat-elevation-z3"],[1,"d-flex","flex-row","flex-wrap","btn-block","align-items-center"],[1,"flex-grow-1"],["appearance","outline",2,"margin-right","8px"],["matInput","",3,"matDatepicker","formControl"],["matSuffix","",3,"for"],[3,"touchUi"],["pickerFromSaleTrendDay",""],["appearance","outline"],["pickerToSaleTrendDay",""],["mat-flat-button","","color","primary",1,"ft-button","dashboard-refresh-button",3,"disabled","click"],[4,"ngIf"],["style","display: inline-block","mode","indeterminate","color","primary",3,"diameter",4,"ngIf"],[1,"row"],[1,"col-12",2,"padding","8px"],["id","salesTrendByDay"],[3,"isLoading",4,"ngIf"],["mode","indeterminate","color","primary",2,"display","inline-block",3,"diameter"],[3,"isLoading"]],template:function(t,e){if(1&t&&(s.Vb(0,"div",0),s.Vb(1,"mat-card",1),s.Vb(2,"h6"),s.Gc(3,"Total Sales Report"),s.Ub(),s.Vb(4,"div",2),s.Qb(5,"span",3),s.Vb(6,"div"),s.Vb(7,"mat-form-field",4),s.Vb(8,"mat-label"),s.Gc(9,"From Date"),s.Ub(),s.Qb(10,"input",5),s.Qb(11,"mat-datepicker-toggle",6),s.Qb(12,"mat-datepicker",7,8),s.Ub(),s.Vb(14,"mat-form-field",9),s.Vb(15,"mat-label"),s.Gc(16,"To Date"),s.Ub(),s.Qb(17,"input",5),s.Qb(18,"mat-datepicker-toggle",6),s.Qb(19,"mat-datepicker",7,10),s.Ub(),s.Vb(21,"button",11),s.dc("click",(function(){return e.refreshTrendReport()})),s.Ec(22,it,2,0,"mat-icon",12),s.Ec(23,ct,1,1,"mat-progress-spinner",13),s.Ub(),s.Ub(),s.Ub(),s.Vb(24,"div",14),s.Vb(25,"div",15),s.Vb(26,"mat-card-content"),s.Qb(27,"div",16),s.Ec(28,st,1,1,"app-data-not-ready",17),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub()),2&t){var o=s.tc(13),n=s.tc(20);s.Cb(10),s.nc("matDatepicker",o)("formControl",e.salesTrendDayFromDateFormControl),s.Cb(1),s.nc("for",o),s.Cb(1),s.nc("touchUi",!0),s.Cb(5),s.nc("matDatepicker",n)("formControl",e.salesTrendDayToDateFormControl),s.Cb(1),s.nc("for",n),s.Cb(1),s.nc("touchUi",!0),s.Cb(2),s.nc("disabled",e.salesByDayTrendProgress),s.Cb(1),s.nc("ngIf",!e.salesByDayTrendProgress),s.Cb(1),s.nc("ngIf",e.salesByDayTrendProgress),s.Cb(5),s.nc("ngIf",e.noDataRetrieved||e.isLoading)}},directives:[D.a,U.b,U.f,V.b,S.f,g.c,g.r,g.h,S.h,U.i,S.d,nt.b,a.t,D.d,at.a,rt.a,x.a],styles:[""]}),t}(),ut=function(t,e){return o=this,void 0,a=function(){var o,n;return function(t,e){var o,n,a,r,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(r){return function(c){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;i;)try{if(o=1,n&&(a=2&r[0]?n.return:r[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,r[1])).done)return a;switch(n=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,n=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==r[0]&&2!==r[0])){i=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){i.label=r[1];break}if(6===r[0]&&i.label<a[1]){i.label=a[1],a=r;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(r);break}a[2]&&i.ops.pop(),i.trys.pop();continue}r=e.call(t,i)}catch(c){r=[6,c],n=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,c])}}}(this,(function(a){if(o="",t&&Array.isArray(t))return o=o.concat(t.join(",")).concat(",\n"),e.forEach((function(e){t.forEach((function(t){o=o.concat(e[t]).concat(", ")})),o=o.concat("\n")})),n=encodeURI("data:text/csv;charset=utf-8,"+o),window.open(n),[2,o];throw Error("CSV failed to crete")}))},new((n=void 0)||(n=Promise))((function(t,e){function r(t){try{c(a.next(t))}catch(o){e(o)}}function i(t){try{c(a.throw(t))}catch(o){e(o)}}function c(e){var o;e.done?t(e.value):(o=e.value,o instanceof n?o:new n((function(t){t(o)}))).then(r,i)}c((a=a.apply(o,[])).next())}));var o,n,a},dt=o("OJ6B");function bt(t,e){1&t&&s.Qb(0,"mat-spinner")}function pt(t,e){1&t&&s.Qb(0,"app-data-not-ready")}function ft(t,e){1&t&&(s.Vb(0,"th",24),s.Gc(1,"Cart Receipt"),s.Ub())}function mt(t,e){if(1&t&&(s.Vb(0,"td",25),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o._id)}}function ht(t,e){1&t&&s.Qb(0,"td",26)}function gt(t,e){1&t&&(s.Vb(0,"th",24),s.Gc(1,"Total Amount"),s.Ub())}function vt(t,e){if(1&t&&(s.Vb(0,"td",25),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o.amount)}}function yt(t,e){1&t&&s.Qb(0,"td",26)}function Ct(t,e){1&t&&(s.Vb(0,"th",24),s.Gc(1,"Total Items"),s.Ub())}function wt(t,e){if(1&t&&(s.Vb(0,"td",25),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o.quantity)}}function Dt(t,e){1&t&&s.Qb(0,"td",26)}function Ut(t,e){1&t&&(s.Vb(0,"th",24),s.Gc(1,"Seller"),s.Ub())}function Vt(t,e){if(1&t&&(s.Vb(0,"td",25),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o.seller)}}function St(t,e){1&t&&s.Qb(0,"td",26)}function kt(t,e){1&t&&(s.Vb(0,"th",24),s.Gc(1,"Date Sold"),s.Ub())}function Rt(t,e){if(1&t&&(s.Vb(0,"td",25),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o.date)}}function xt(t,e){1&t&&s.Qb(0,"td",26)}function Et(t,e){1&t&&s.Qb(0,"tr",27)}function Pt(t,e){1&t&&s.Qb(0,"tr",28),2&t&&s.oc("matTooltip",e.$implicit.product)}function Tt(t,e){1&t&&s.Qb(0,"tr",29)}function _t(t,e){if(1&t&&(s.Vb(0,"table",12),s.Tb(1,13),s.Ec(2,ft,2,0,"th",14),s.Ec(3,mt,2,1,"td",15),s.Ec(4,ht,1,0,"td",16),s.Sb(),s.Tb(5,17),s.Ec(6,gt,2,0,"th",14),s.Ec(7,vt,2,1,"td",15),s.Ec(8,yt,1,0,"td",16),s.Sb(),s.Tb(9,18),s.Ec(10,Ct,2,0,"th",14),s.Ec(11,wt,2,1,"td",15),s.Ec(12,Dt,1,0,"td",16),s.Sb(),s.Tb(13,19),s.Ec(14,Ut,2,0,"th",14),s.Ec(15,Vt,2,1,"td",15),s.Ec(16,St,1,0,"td",16),s.Sb(),s.Tb(17,20),s.Ec(18,kt,2,0,"th",14),s.Ec(19,Rt,2,1,"td",15),s.Ec(20,xt,1,0,"td",16),s.Sb(),s.Ec(21,Et,1,0,"tr",21),s.Ec(22,Pt,1,1,"tr",22),s.Ec(23,Tt,1,0,"tr",23),s.Ub()),2&t){var o=s.hc();s.nc("dataSource",o.carts),s.Cb(21),s.nc("matHeaderRowDef",o.cartColumns),s.Cb(1),s.nc("matRowDefColumns",o.cartColumns),s.Cb(1),s.nc("matFooterRowDef",o.cartColumns)}}var Ft=function(){return[10,20,100]},It=function(){function t(t,e){this.report=t,this.snack=e,this.isLoading=!1,this.noDataRetrieved=!0,this.stocks=[],this.cartColumns=["receipt","total_amount","total_items","seller","date"]}return t.prototype.ngOnInit=function(){var t=this;this.isLoading=!0,this.report.getSoldCarts(Object(y.a)(new Date),Object(y.a)(new Date),"retail").then((function(e){t.isLoading=!1,e&&Array.isArray(e)&&e.length>0?(t.carts=new b.o(e),t.carts.paginator=t.paginator,t.stocks=e,t.carts.sort=t.sort,t.noDataRetrieved=!1):t.noDataRetrieved=!0})).catch((function(e){t.isLoading=!1,t.snack.open("Fails to get total expired products","Ok",{duration:3e3})}))},t.prototype.exportReport=function(){ut(this.cartColumns,this.carts.data).then(console.log)},t.\u0275fac=function(e){return new(e||t)(s.Pb(v.a),s.Pb(w.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-cart-report"]],viewQuery:function(t,e){var o;1&t&&(s.Cc(f.a,!0),s.Cc(C.a,!0)),2&t&&(s.sc(o=s.ec())&&(e.paginator=o.first),s.sc(o=s.ec())&&(e.sort=o.first))},features:[s.Bb([v.a])],decls:19,vars:6,consts:[[1,"col-12",2,"margin-top","1em"],[1,"mat-elevation-z3"],[2,"display","flex","flex-flow","row","align-items","center"],[1,"col-8"],[2,"flex-grow","1"],["mat-icon-button","",3,"mat-menu-trigger-for"],[2,"display","flex","justify-content","center"],[4,"ngIf"],["mat-table","","matSort","",3,"dataSource",4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],["exportMenu",""],["mat-menu-item","",3,"click"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","receipt"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","total_amount"],["matColumnDef","total_items"],["matColumnDef","seller"],["matColumnDef","date"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","style","font-size: 36px",4,"matFooterRowDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"],["mat-footer-row","",2,"font-size","36px"]],template:function(t,e){if(1&t&&(s.Vb(0,"div",0),s.Vb(1,"div"),s.Vb(2,"mat-card",1),s.Vb(3,"div",2),s.Vb(4,"h6",3),s.Gc(5,"Cart Report"),s.Ub(),s.Qb(6,"span",4),s.Vb(7,"button",5),s.Vb(8,"mat-icon"),s.Gc(9,"more_vert"),s.Ub(),s.Ub(),s.Ub(),s.Vb(10,"div",6),s.Ec(11,bt,1,0,"mat-spinner",7),s.Ub(),s.Ec(12,pt,1,0,"app-data-not-ready",7),s.Ec(13,_t,24,4,"table",8),s.Qb(14,"mat-paginator",9),s.Ub(),s.Ub(),s.Ub(),s.Vb(15,"mat-menu",null,10),s.Vb(17,"button",11),s.dc("click",(function(){return e.exportReport()})),s.Gc(18," Export "),s.Ub(),s.Ub()),2&t){var o=s.tc(16);s.Cb(7),s.nc("mat-menu-trigger-for",o),s.Cb(4),s.nc("ngIf",e.isLoading),s.Cb(1),s.nc("ngIf",e.noDataRetrieved&&!e.isLoading),s.Cb(1),s.nc("ngIf",!e.noDataRetrieved&&!e.isLoading),s.Cb(1),s.nc("pageSizeOptions",s.pc(5,Ft))}},directives:[D.a,nt.b,dt.d,at.a,a.t,f.a,dt.e,dt.b,rt.c,x.a,b.n,C.a,b.c,b.i,b.b,b.e,b.k,b.m,b.g,b.h,C.b,b.a,b.d,b.j,b.l,E.a,b.f],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),t}(),Gt=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),jt=["sidenav"],Qt=function(t){return{padding:t}},Lt=function(t){function e(){var e=t.call(this)||this;return e.isMobile=c.a.android,e}return Gt(e,t),e.prototype.ngOnInit=function(){},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Jb({type:e,selectors:[["app-sales-reports"]],viewQuery:function(t,e){var o;1&t&&s.Mc(jt,!0),2&t&&s.sc(o=s.ec())&&(e.sidenav=o.first)},features:[s.zb],decls:16,vars:10,consts:[[1,"my-drawer-container"],[1,"match-parent-side",3,"fixedInViewport","mode","opened"],["sidenav",""],[3,"heading","sidenav","showProgress"],[3,"ngStyle","ngClass"],[1,"col-12","col-lg-10","col-xl-10","offset-xl-1","offset-lg-1","offset-md-0","offset-sm-0"],[1,"row"],[1,"col-12",2,"margin-bottom","10px"],[2,"margin-bottom","1em"]],template:function(t,e){if(1&t&&(s.Vb(0,"div"),s.Vb(1,"mat-sidenav-container",0),s.Vb(2,"mat-sidenav",1,2),s.Qb(4,"app-admin-drawer"),s.Ub(),s.Vb(5,"mat-sidenav-content"),s.Qb(6,"app-toolbar",3),s.Vb(7,"div",4),s.Vb(8,"div",5),s.Vb(9,"div",6),s.Vb(10,"div",7),s.Qb(11,"app-product-performance-report",8),s.Ub(),s.Vb(12,"div",7),s.Qb(13,"app-dashboard-sale-trends"),s.Ub(),s.Vb(14,"div",7),s.Qb(15,"app-cart-report"),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub()),2&t){var o=s.tc(3);s.Cb(2),s.nc("fixedInViewport",!0)("mode",e.enoughWidth()?"side":"over")("opened",e.enoughWidth()),s.Cb(4),s.nc("heading","REPORT")("sidenav",o)("showProgress",!1),s.Cb(1),s.nc("ngStyle",s.qc(8,Qt,e.isMobile||!e.enoughWidth()?"24px 0":"40px 16px"))("ngClass",e.isMobile||!e.enoughWidth()?"container-fluid":"container")}},directives:[l.e,l.d,u.a,l.f,d.a,a.w,a.q,et,lt,It],styles:[""]}),e}(i.a),Ot=o("eUy1");function At(t,e){if(1&t&&s.Qb(0,"app-data-not-ready",9),2&t){var o=s.hc();s.nc("isLoading",o.isLoading)}}function Bt(t,e){1&t&&(s.Vb(0,"th",20),s.Gc(1,"Product"),s.Ub())}function Ht(t,e){if(1&t&&(s.Vb(0,"td",21),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o.product)}}function Mt(t,e){1&t&&(s.Vb(0,"th",20),s.Gc(1,"Quantity"),s.Ub())}function $t(t,e){if(1&t&&(s.Vb(0,"td",21),s.Gc(1),s.ic(2,"number"),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(s.jc(2,1,o.quantity))}}function zt(t,e){1&t&&(s.Vb(0,"th",20),s.Gc(1,"Reorder level"),s.Ub())}function qt(t,e){if(1&t&&(s.Vb(0,"td",21),s.Gc(1),s.ic(2,"number"),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(s.jc(2,1,o.reorder))}}function Jt(t,e){1&t&&(s.Vb(0,"th",20),s.Gc(1,"Supplier"),s.Ub())}function Wt(t,e){if(1&t&&(s.Vb(0,"td",22),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o.supplier)}}function Nt(t,e){1&t&&s.Qb(0,"tr",23)}function Zt(t,e){1&t&&s.Qb(0,"tr",24),2&t&&s.oc("matTooltip",e.$implicit.product)}function Yt(t,e){if(1&t&&(s.Vb(0,"div"),s.Vb(1,"table",10),s.Tb(2,11),s.Ec(3,Bt,2,0,"th",12),s.Ec(4,Ht,2,1,"td",13),s.Sb(),s.Tb(5,14),s.Ec(6,Mt,2,0,"th",12),s.Ec(7,$t,3,3,"td",13),s.Sb(),s.Tb(8,15),s.Ec(9,zt,2,0,"th",12),s.Ec(10,qt,3,3,"td",13),s.Sb(),s.Tb(11,16),s.Ec(12,Jt,2,0,"th",12),s.Ec(13,Wt,2,1,"td",17),s.Sb(),s.Ec(14,Nt,1,0,"tr",18),s.Ec(15,Zt,1,1,"tr",19),s.Ub(),s.Ub()),2&t){var o=s.hc();s.Cb(1),s.nc("dataSource",o.stockReorderDatasource),s.Cb(13),s.nc("matHeaderRowDef",o.stockColumns),s.Cb(1),s.nc("matRowDefColumns",o.stockColumns)}}var Kt=function(){return[5,20,100]},Xt=function(){function t(t,e,o,n,a,r){this.router=t,this.indexDb=e,this.snack=o,this.logger=n,this._report=a,this.stockDatabase=r,this.stockFetchProgress=!1,this.startDateFormControl=new g.g("",[g.F.nullValidator]),this.endDateFormControl=new g.g("",[g.F.nullValidator]),this.stockReportGetProgress=!1,this.isLoading=!1,this.noDataRetrieved=!0,this.hotReloadProgress=!1,this.totalPurchase=Object(h.a)(0),this.stockColumns=["product","quantity","reorder","supplier"]}return t.prototype.ngOnInit=function(){this._getStockReport()},t.prototype._getStockReport=function(){var t=this;this.isLoading=!0,this.stockReportGetProgress=!0,this._report.getStockReorderReportReport(0,1e3).then((function(e){t.stockReport=e.length>0?e[0].total:0,t.isLoading=!1,e&&Array.isArray(e)&&e.length>0?(t.stockReorderDatasource=new b.o(e),t.stockReorderDatasource.paginator=t.paginator,t.stockReorderDatasource.sort=t.sort,t.stockReportGetProgress=!1,t.noDataRetrieved=!1):t.noDataRetrieved=!0})).catch((function(e){t.isLoading=!1,t.stockReport=0,console.log(e),t.snack.open("Fails to get total sales","Ok",{duration:3e3}),t.stockReportGetProgress=!1}))},t.prototype.exportReport=function(){ut(this.stockColumns,this.stockReorderDatasource.data).then(console.log)},t.\u0275fac=function(e){return new(e||t)(s.Pb(r.b),s.Pb(p.a),s.Pb(w.a),s.Pb(m.a),s.Pb(v.a),s.Pb(Ot.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-stock-reorder-report"]],viewQuery:function(t,e){var o;1&t&&(s.Cc(f.a,!0),s.Cc(C.a,!0)),2&t&&(s.sc(o=s.ec())&&(e.paginator=o.first),s.sc(o=s.ec())&&(e.sort=o.first))},features:[s.Bb([v.a])],decls:16,vars:5,consts:[[1,"mat-elevation-z3"],[2,"display","flex","flex-flow","row","align-items","center"],[2,"flex-grow","1"],["mat-icon-button","",3,"mat-menu-trigger-for"],[3,"isLoading",4,"ngIf"],[4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],["exportMenu",""],["mat-menu-item","",3,"click"],[3,"isLoading"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","quantity"],["matColumnDef","reorder"],["matColumnDef","supplier"],["matRipple","","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["matRipple","","mat-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"]],template:function(t,e){if(1&t&&(s.Vb(0,"div"),s.Vb(1,"mat-card",0),s.Vb(2,"div",1),s.Vb(3,"h6"),s.Gc(4,"Stock Reorder"),s.Ub(),s.Qb(5,"span",2),s.Vb(6,"button",3),s.Vb(7,"mat-icon"),s.Gc(8,"more_vert"),s.Ub(),s.Ub(),s.Ub(),s.Ec(9,At,1,1,"app-data-not-ready",4),s.Ec(10,Yt,16,3,"div",5),s.Qb(11,"mat-paginator",6),s.Ub(),s.Ub(),s.Vb(12,"mat-menu",null,7),s.Vb(14,"button",8),s.dc("click",(function(){return e.exportReport()})),s.Gc(15," Export"),s.Ub(),s.Ub()),2&t){var o=s.tc(13);s.Cb(6),s.nc("mat-menu-trigger-for",o),s.Cb(3),s.nc("ngIf",e.noDataRetrieved||e.isLoading),s.Cb(1),s.nc("ngIf",!e.noDataRetrieved&&!e.isLoading),s.Cb(1),s.nc("pageSizeOptions",s.pc(4,Kt))}},directives:[D.a,nt.b,dt.d,at.a,a.t,f.a,dt.e,dt.b,x.a,b.n,C.a,b.c,b.i,b.b,b.k,b.m,b.h,C.b,b.a,R.s,b.j,b.l,E.a],pipes:[a.g],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),t}();function te(t,e){if(1&t&&s.Qb(0,"app-data-not-ready",10),2&t){var o=s.hc();s.nc("isLoading",o.isLoading)}}function ee(t,e){1&t&&(s.Vb(0,"th",18),s.Gc(1,"Product"),s.Ub())}function oe(t,e){if(1&t&&(s.Vb(0,"td",19),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o.product)}}function ne(t,e){1&t&&(s.Vb(0,"th",18),s.Gc(1,"Expiry Date"),s.Ub())}function ae(t,e){if(1&t&&(s.Vb(0,"td",19),s.Gc(1),s.ic(2,"date"),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(s.jc(2,1,o.expire))}}function re(t,e){1&t&&s.Qb(0,"tr",20)}function ie(t,e){1&t&&s.Qb(0,"tr",21),2&t&&s.oc("matTooltip",e.$implicit.product)}function ce(t,e){if(1&t&&(s.Vb(0,"table",11),s.Tb(1,12),s.Ec(2,ee,2,0,"th",13),s.Ec(3,oe,2,1,"td",14),s.Sb(),s.Tb(4,15),s.Ec(5,ne,2,0,"th",13),s.Ec(6,ae,3,3,"td",14),s.Sb(),s.Ec(7,re,1,0,"tr",16),s.Ec(8,ie,1,1,"tr",17),s.Ub()),2&t){var o=s.hc();s.nc("dataSource",o.expiredProducts),s.Cb(7),s.nc("matHeaderRowDef",o.stockColumns),s.Cb(1),s.nc("matRowDefColumns",o.stockColumns)}}var se=function(){return[5,20,100]},le=function(){function t(t,e){this.report=t,this.snack=e,this.isLoading=!1,this.noDataRetrieved=!0,this.stockColumns=["product","expire"]}return t.prototype.ngOnInit=function(){var t=this;this.isLoading=!0,this.report.getExpiredProducts(new Date,0,1e3).then((function(e){t.isLoading=!1,e&&Array.isArray(e)&&e.length>0?(t.expiredProducts=new b.o(e),t.expiredProducts.paginator=t.paginator,t.expiredProducts.sort=t.sort,t.noDataRetrieved=!1):t.noDataRetrieved=!0})).catch((function(e){t.isLoading=!1,console.log(e),t.snack.open("Fails to get total expired products","Ok",{duration:3e3})}))},t.prototype.exportReport=function(){ut(this.stockColumns,this.expiredProducts.data).then(console.log)},t.\u0275fac=function(e){return new(e||t)(s.Pb(v.a),s.Pb(w.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-expired-products-report"]],viewQuery:function(t,e){var o;1&t&&(s.Cc(f.a,!0),s.Cc(C.a,!0)),2&t&&(s.sc(o=s.ec())&&(e.paginator=o.first),s.sc(o=s.ec())&&(e.sort=o.first))},features:[s.Bb([v.a])],decls:16,vars:5,consts:[[1,"mat-elevation-z3"],[2,"display","flex","flex-flow","row","align-items","center"],[1,"col-8"],[2,"flex-grow","1"],["mat-icon-button","",3,"mat-menu-trigger-for"],[3,"isLoading",4,"ngIf"],["mat-table","","matSort","",3,"dataSource",4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],["exportMenu",""],["mat-menu-item","",3,"click"],[3,"isLoading"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","expire"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"]],template:function(t,e){if(1&t&&(s.Vb(0,"div"),s.Vb(1,"mat-card",0),s.Vb(2,"div",1),s.Vb(3,"h6",2),s.Gc(4,"Expired"),s.Ub(),s.Qb(5,"span",3),s.Vb(6,"button",4),s.Vb(7,"mat-icon"),s.Gc(8,"more_vert"),s.Ub(),s.Ub(),s.Ub(),s.Ec(9,te,1,1,"app-data-not-ready",5),s.Ec(10,ce,9,3,"table",6),s.Qb(11,"mat-paginator",7),s.Ub(),s.Ub(),s.Vb(12,"mat-menu",null,8),s.Vb(14,"button",9),s.dc("click",(function(){return e.exportReport()})),s.Gc(15," Export"),s.Ub(),s.Ub()),2&t){var o=s.tc(13);s.Cb(6),s.nc("mat-menu-trigger-for",o),s.Cb(3),s.nc("ngIf",e.noDataRetrieved||e.isLoading),s.Cb(1),s.nc("ngIf",!e.noDataRetrieved&&!e.isLoading),s.Cb(1),s.nc("pageSizeOptions",s.pc(4,se))}},directives:[D.a,nt.b,dt.d,at.a,a.t,f.a,dt.e,dt.b,x.a,b.n,C.a,b.c,b.i,b.b,b.k,b.m,b.h,C.b,b.a,b.j,b.l,E.a],pipes:[a.f],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),t}();function ue(t,e){if(1&t&&s.Qb(0,"app-data-not-ready",10),2&t){var o=s.hc();s.nc("isLoading",o.isLoading)}}function de(t,e){1&t&&(s.Vb(0,"th",19),s.Gc(1,"Product"),s.Ub())}function be(t,e){if(1&t&&(s.Vb(0,"td",20),s.Gc(1),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(o.product)}}function pe(t,e){1&t&&(s.Vb(0,"th",19),s.Gc(1,"Expiry Date"),s.Ub())}function fe(t,e){if(1&t&&(s.Vb(0,"td",20),s.Gc(1),s.ic(2,"date"),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(s.jc(2,1,o.expire))}}function me(t,e){1&t&&(s.Vb(0,"th",19),s.Gc(1,"Quantity Remaining"),s.Ub())}function he(t,e){if(1&t&&(s.Vb(0,"td",20),s.Gc(1),s.ic(2,"number"),s.Ub()),2&t){var o=e.$implicit;s.Cb(1),s.Hc(s.jc(2,1,o.quantity))}}function ge(t,e){1&t&&s.Qb(0,"tr",21)}function ve(t,e){1&t&&s.Qb(0,"tr",22),2&t&&s.oc("matTooltip",e.$implicit.product)}function ye(t,e){if(1&t&&(s.Vb(0,"table",11),s.Tb(1,12),s.Ec(2,de,2,0,"th",13),s.Ec(3,be,2,1,"td",14),s.Sb(),s.Tb(4,15),s.Ec(5,pe,2,0,"th",13),s.Ec(6,fe,3,3,"td",14),s.Sb(),s.Tb(7,16),s.Ec(8,me,2,0,"th",13),s.Ec(9,he,3,3,"td",14),s.Sb(),s.Ec(10,ge,1,0,"tr",17),s.Ec(11,ve,1,1,"tr",18),s.Ub()),2&t){var o=s.hc();s.nc("dataSource",o.expiredProducts),s.Cb(10),s.nc("matHeaderRowDef",o.stockColumns),s.Cb(1),s.nc("matRowDefColumns",o.stockColumns)}}var Ce=function(){return[5,20,100]},we=function(){function t(t,e){this.report=t,this.snack=e,this.isLoading=!1,this.noDataRetrieved=!0,this.stocks=[],this.stockColumns=["product","expire","quantity"]}return t.prototype.ngOnInit=function(){var t=this;this.isLoading=!0,this.report.getProductsAboutToExpire().then((function(e){t.isLoading=!1,e&&Array.isArray(e)&&e.length>0?(t.expiredProducts=new b.o(e),t.expiredProducts.paginator=t.paginator,t.stocks=e,t.expiredProducts.sort=t.sort,t.noDataRetrieved=!1):t.noDataRetrieved=!0})).catch((function(e){t.isLoading=!1,console.log(e),t.snack.open("Fails to get total expired products","Ok",{duration:3e3})}))},t.prototype.exportReport=function(){ut(this.stockColumns,this.expiredProducts.data).then(console.log)},t.\u0275fac=function(e){return new(e||t)(s.Pb(v.a),s.Pb(w.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["app-products-about-to-expire"]],viewQuery:function(t,e){var o;1&t&&(s.Cc(f.a,!0),s.Cc(C.a,!0)),2&t&&(s.sc(o=s.ec())&&(e.paginator=o.first),s.sc(o=s.ec())&&(e.sort=o.first))},features:[s.Bb([v.a])],decls:16,vars:5,consts:[[1,"mat-elevation-z3"],[2,"display","flex","flex-flow","row","align-items","center"],[1,"col-8"],[2,"flex-grow","1"],["mat-icon-button","",3,"mat-menu-trigger-for"],[3,"isLoading",4,"ngIf"],["mat-table","","matSort","",3,"dataSource",4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],["exportMenu",""],["mat-menu-item","",3,"click"],[3,"isLoading"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","expire"],["matColumnDef","quantity"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"]],template:function(t,e){if(1&t&&(s.Vb(0,"div"),s.Vb(1,"mat-card",0),s.Vb(2,"div",1),s.Vb(3,"h6",2),s.Gc(4,"Near to Expire"),s.Ub(),s.Qb(5,"span",3),s.Vb(6,"button",4),s.Vb(7,"mat-icon"),s.Gc(8,"more_vert"),s.Ub(),s.Ub(),s.Ub(),s.Ec(9,ue,1,1,"app-data-not-ready",5),s.Ec(10,ye,12,3,"table",6),s.Qb(11,"mat-paginator",7),s.Ub(),s.Ub(),s.Vb(12,"mat-menu",null,8),s.Vb(14,"button",9),s.dc("click",(function(){return e.exportReport()})),s.Gc(15," Export"),s.Ub(),s.Ub()),2&t){var o=s.tc(13);s.Cb(6),s.nc("mat-menu-trigger-for",o),s.Cb(3),s.nc("ngIf",e.noDataRetrieved||e.isLoading),s.Cb(1),s.nc("ngIf",!e.noDataRetrieved&&!e.isLoading),s.Cb(1),s.nc("pageSizeOptions",s.pc(4,Ce))}},directives:[D.a,nt.b,dt.d,at.a,a.t,f.a,dt.e,dt.b,x.a,b.n,C.a,b.c,b.i,b.b,b.k,b.m,b.h,C.b,b.a,b.j,b.l,E.a],pipes:[a.f,a.g],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),t}(),De=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Ue=function(t){return{padding:t}},Ve=[{path:"",redirectTo:"sales",pathMatch:"full"},{path:"sales",component:Lt},{path:"stocks",component:function(t){function e(){var e=t.call(this)||this;return e.isMobile=c.a.android,e}return De(e,t),e.prototype.ngOnInit=function(){},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Jb({type:e,selectors:[["app-stock-reports"]],features:[s.zb],decls:17,vars:10,consts:[[1,"my-drawer-container"],[1,"match-parent-side",3,"fixedInViewport","mode","opened"],["sidenav",""],[3,"heading","sidenav","showProgress"],[3,"ngStyle","ngClass"],[1,"col-12","col-lg-10","col-xl-10","offset-xl-1","offset-lg-1","offset-md-0","offset-sm-0"],[1,"row"],[1,"col-12",2,"margin-bottom","10px"],[1,"col-xl-6","col-lg-6","col-md-6","col-sm-12","col-12",2,"margin-bottom","10px"]],template:function(t,e){if(1&t&&(s.Vb(0,"div"),s.Vb(1,"mat-sidenav-container",0),s.Vb(2,"mat-sidenav",1,2),s.Qb(4,"app-admin-drawer"),s.Ub(),s.Vb(5,"mat-sidenav-content"),s.Qb(6,"app-toolbar",3),s.Vb(7,"div",4),s.Vb(8,"div",5),s.Vb(9,"div",6),s.Vb(10,"div",7),s.Qb(11,"app-stock-reorder-report"),s.Ub(),s.Ub(),s.Vb(12,"div",6),s.Vb(13,"div",8),s.Qb(14,"app-expired-products-report"),s.Ub(),s.Vb(15,"div",8),s.Qb(16,"app-products-about-to-expire"),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub(),s.Ub()),2&t){var o=s.tc(3);s.Cb(2),s.nc("fixedInViewport",!0)("mode",e.enoughWidth()?"side":"over")("opened",e.enoughWidth()),s.Cb(4),s.nc("heading","REPORT")("sidenav",o)("showProgress",!1),s.Cb(1),s.nc("ngStyle",s.qc(8,Ue,e.isMobile||!e.enoughWidth()?"24px 0":"24px 16px"))("ngClass",e.isMobile||!e.enoughWidth()?"container-fluid":"container")}},directives:[l.e,l.d,u.a,l.f,d.a,a.w,a.q,Xt,le,we],styles:[""]}),e}(i.a)}],Se=function(){function t(){}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},imports:[[r.f.forChild(Ve)],r.f]}),t}(),ke=o("luHr"),Re=o("/OYs"),xe=o("29jt"),Ee=o("XIAg"),Pe=o("0baF"),Te=function(){function t(){}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},imports:[[a.c,Se,S.g,ke.a,Re.a,l.g,D.j,U.d,S.g,g.B,V.c,b.p,f.b,C.c,at.b,nt.c,rt.b,R.l,E.b,k.b,xe.e,xe.g,Ee.b,V.c,dt.c,Pe.DashboardModuleModule,R.t]]}),t}()}}]);