(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{fm87:function(t,e,o){"use strict";o.r(e),o.d(e,"ReportsModule",(function(){return co}));var r=o("ofXK"),a=o("iadO"),n=o("AytR"),c=o("wROQ"),i=o("fXoL"),s=o("XhcP"),l=o("veC1"),u=o("eQIs"),d=o("+0xr"),b=o("3Pt+"),f=o("nBS7"),m=o("Qfq9"),p=o("LRne"),h=o("M9IT"),g=o("Dh3D"),v=o("CLz7"),R=function(t,e){return o=this,void 0,a=function(){var o,r;return function(t,e){var o,r,a,n,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function i(n){return function(i){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(a=2&n[0]?r.return:n[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,n[1])).done)return a;switch(r=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,r=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(!((a=(a=c.trys).length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(i){n=[6,i],r=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,i])}}}(this,(function(a){if(o="",t&&Array.isArray(t))return o=o.concat(t.join(",")).concat(",\n"),e.forEach((function(e){t.forEach((function(t){o=o.concat(e[t]).concat(", ")})),o=o.concat("\n")})),r=encodeURI("data:text/csv;charset=utf-8,"+o),window.open(r),[2,o];throw Error("CSV failed to crete")}))},new((r=void 0)||(r=Promise))((function(t,e){function n(t){try{i(a.next(t))}catch(o){e(o)}}function c(t){try{i(a.throw(t))}catch(o){e(o)}}function i(e){var o;e.done?t(e.value):(o=e.value,o instanceof r?o:new r((function(t){t(o)}))).then(n,c)}i((a=a.apply(o,[])).next())}));var o,r,a},C=o("VcMg"),S=o("4vfi"),y=o("wd/R"),D=o("Jedy"),w=o("tk/3"),k=function(t,e,o,r){return new(o||(o=Promise))((function(a,n){function c(t){try{s(r.next(t))}catch(e){n(e)}}function i(t){try{s(r.throw(t))}catch(e){n(e)}}function s(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(c,i)}s((r=r.apply(t,e||[])).next())}))},P=function(t,e){var o,r,a,n,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return n={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function i(n){return function(i){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,r&&(a=2&n[0]?r.return:n[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,n[1])).done)return a;switch(r=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,r=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(!((a=(a=c.trys).length>0&&a[a.length-1])||6!==n[0]&&2!==n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(i){n=[6,i],r=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,i])}}},F=function(){function t(t,e,o){this.httpClient=t,this.storage=e,this.settings=o}return t.prototype.getFrequentlySoldProducts=function(t,e){var o=this;return new Promise((function(e,r){return k(o,void 0,void 0,(function(){var o,a;return P(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.storage.getActiveShop()];case 1:return o=n.sent(),this.httpClient.get(this.settings.ssmFunctionsURL+"/dashboard/admin/dailySales/"+o.projectId+"/"+t,{headers:this.settings.ssmFunctionsHeader}).subscribe((function(t){e(t)}),(function(t){r(t)})),[3,3];case 2:return a=n.sent(),r(a),[3,3];case 3:return[2]}}))}))}))},t.prototype.getSalesTrend=function(t,e){var o=this;return new Promise((function(r,a){return k(o,void 0,void 0,(function(){var o,n;return P(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,this.storage.getActiveShop()];case 1:return o=c.sent(),this.httpClient.get(this.settings.ssmFunctionsURL+"/dashboard/admin/salesGraphData/day/"+o.projectId+"/"+t+"/"+e,{headers:this.settings.ssmFunctionsHeader}).subscribe((function(t){r(t)}),(function(t){a(t)})),[3,3];case 2:return n=c.sent(),a(n),[3,3];case 3:return[2]}}))}))}))},t.prototype.getTotalCostOfGoodSold=function(t,e){var o=this;return new Promise((function(e,r){return k(o,void 0,void 0,(function(){var o,a;return P(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.storage.getActiveShop()];case 1:return o=n.sent(),this.httpClient.get(this.settings.ssmFunctionsURL+"/dashboard/admin/stock/"+o.projectId+"/"+t,{headers:this.settings.ssmFunctionsHeader}).subscribe((function(t){e(t)}),(function(t){r(t)})),[3,3];case 2:return a=n.sent(),r(a),[3,3];case 3:return[2]}}))}))}))},t.prototype.getTotalSale=function(t,e){return k(this,void 0,void 0,(function(){var o,r,a,n;return P(this,(function(c){switch(c.label){case 0:return[4,this.storage.getActiveShop()];case 1:return o=c.sent(),[4,S.BFast.database(o.projectId).collection("sales").query().lessThanOrEqual("date",Object(D.a)(e)).greaterThanOrEqual("date",Object(D.a)(t)).count(!0).find()];case 2:return r=c.sent(),[4,S.BFast.database(o.projectId).collection("sales").query().lessThanOrEqual("date",Object(D.a)(e)).greaterThanOrEqual("date",Object(D.a)(t)).skip(0).size(r).find({returnFields:["amount","batch"]})];case 3:return a=c.sent(),n={batch:"a",value:"a"},[2,(a=a.filter((function(t){return n[t.batch]!==t.batch&&(n[t.batch]=t.batch,!0)}))).map((function(t){return t.amount})).reduce((function(t,e){return t+e}),0)]}}))}))},t.prototype.getProductPerformanceReport=function(t,e,o){var r=this;return new Promise((function(t,a){return k(r,void 0,void 0,(function(){var r,n;return P(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,this.storage.getActiveShop()];case 1:return r=c.sent(),this.httpClient.get(this.settings.ssmFunctionsURL+"/dashboard/sales-reports/productPerformanceReport/"+r.projectId+"/"+e+"/"+o,{headers:this.settings.ssmFunctionsHeader}).subscribe((function(e){t(e)}),(function(t){a(t)})),[3,3];case 2:return n=c.sent(),a(n),[3,3];case 3:return[2]}}))}))}))},t.prototype.getSalesByCategory=function(t,e,o){var r=this;return new Promise((function(t,a){return k(r,void 0,void 0,(function(){var r,n;return P(this,(function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,this.storage.getActiveShop()];case 1:return r=c.sent(),S.BFast.functions().request("/dashboard/sales-reports/profitByCategory/"+r.projectId+"/"+e+"/"+o).get({headers:this.settings.ssmFunctionsHeader}).then((function(e){t(e)})).catch((function(t){a(t)})),[3,3];case 2:return n=c.sent(),a(n),[3,3];case 3:return[2]}}))}))}))},t.prototype.getStockReorderReportReport=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=100),k(this,void 0,void 0,(function(){var t,e;return P(this,(function(o){switch(o.label){case 0:return[4,this.storage.getActiveShop()];case 1:return t=o.sent(),[4,this.storage.getStocks()];case 2:return(e=o.sent())&&Array.isArray(e)&&e.length>0?[3,4]:[4,S.BFast.database(t.projectId).collection("stocks").getAll(null,{cacheEnable:!1,dtl:0})];case 3:e=o.sent(),o.label=4;case 4:return[2,e.filter((function(t){return t.reorder>=t.quantity}))]}}))}))},t.prototype.getExpiredProducts=function(t,e,o){return void 0===e&&(e=0),void 0===o&&(o=1e3),k(this,void 0,void 0,(function(){var r;return P(this,(function(a){switch(a.label){case 0:return[4,this.storage.getActiveShop()];case 1:return r=a.sent(),[2,S.BFast.database(r.projectId).collection("stocks").query().lessThanOrEqual("expire",Object(D.a)(t)).skip(e).size(o).find()]}}))}))},t.prototype.getProductsAboutToExpire=function(){return k(this,void 0,void 0,(function(){var t,e,o;return P(this,(function(r){switch(r.label){case 0:return[4,this.storage.getActiveShop()];case 1:return t=r.sent(),[4,this.storage.getStocks()];case 2:return e=r.sent(),o=new Date,e&&Array.isArray(e)&&e.length>0?[3,4]:[4,S.BFast.database(t.projectId).collection("stocks").getAll(null,{cacheEnable:!1,dtl:0})];case 3:e=r.sent(),r.label=4;case 4:return[2,e.filter((function(t){return t.expire>Object(D.a)(o)&&t.expire<=Object(D.a)(y(o).add(3,"M").toDate())}))]}}))}))},t.prototype.getSoldCarts=function(t,e,o,r,a){return void 0===r&&(r=0),void 0===a&&(a=100),k(this,void 0,void 0,(function(){var r=this;return P(this,(function(a){return[2,new Promise((function(a,n){return k(r,void 0,void 0,(function(){var r,c;return P(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.storage.getActiveShop()];case 1:return r=i.sent(),this.httpClient.get(this.settings.ssmFunctionsURL+"/dashboard/sales-reports/cartOrderReport/"+r.projectId+"/"+o+"/"+t+"/"+e,{headers:this.settings.ssmFunctionsHeader}).subscribe((function(t){a(t)}),(function(t){n(t)})),[3,3];case 2:return c=i.sent(),n(c),[3,3];case 3:return[2]}}))}))}))]}))}))},t.prototype.getTotalGrossSale=function(t,e){return k(this,void 0,void 0,(function(){var o,r,a,n,c,i;return P(this,(function(s){switch(s.label){case 0:return[4,this.storage.getActiveShop()];case 1:return o=s.sent(),[4,S.BFast.database(o.projectId).collection("sales").query().lessThanOrEqual("date",Object(D.a)(e)).greaterThanOrEqual("date",Object(D.a)(t)).count(!0).find()];case 2:return r=s.sent(),[4,S.BFast.database(o.projectId).collection("sales").query().lessThanOrEqual("date",Object(D.a)(e)).greaterThanOrEqual("date",Object(D.a)(t)).skip(0).size(r).find({returnFields:["amount","batch","quantity","stock"]})];case 3:return a=s.sent(),n={batch:"a",value:"a"},a=a.filter((function(t){return n[t.batch]!==t.batch&&(n[t.batch]=t.batch,!0)})),c=a.map((function(t){return t.amount})).reduce((function(t,e){return t+e}),0),i=a.map((function(t){return t.quantity*t.stock.purchase})).reduce((function(t,e){return t+e}),0),[2,c-i]}}))}))},t.prototype.getStockStatus=function(){return k(this,void 0,void 0,(function(){var t,e,o;return P(this,(function(r){switch(r.label){case 0:return[4,this.storage.getActiveShop()];case 1:return t=r.sent(),[4,this.storage.getStocks()];case 2:return e=r.sent(),o=[],e&&Array.isArray(e)&&e.length>0?(o.push({x:"total",y:e.length}),o.push({x:"out",y:e.filter((function(t){return t.quantity<=0})).length}),o.push({x:"order",y:e.filter((function(t){return t.quantity<=t.reorder})).length}),[3,5]):[3,3];case 3:return[4,S.BFast.database(t.projectId).collection("stocks").getAll(null,{cacheEnable:!1,dtl:0})];case 4:e=r.sent(),o.push({x:"total",y:e.length}),o.push({x:"out",y:e.filter((function(t){return t.quantity>0})).length}),o.push({x:"order",y:e.filter((function(t){return t.quantity<=t.reorder})).length}),r.label=5;case 5:return[2,o]}}))}))},t.prototype.getStockStatusByCategory=function(){return k(this,void 0,void 0,(function(){var t,e,o,r;return P(this,(function(a){switch(a.label){case 0:return[4,this.storage.getActiveShop()];case 1:return t=a.sent(),e={},[4,this.storage.getStocks()];case 2:return o=a.sent(),r=[],o&&Array.isArray(o)&&o.length>0?(o.forEach((function(t){return e[t.category]=t.category})),Object.keys(e).forEach((function(t){r.push({x:t,y:o.filter((function(e){return e.category===t})).length})})),[3,5]):[3,3];case 3:return[4,S.BFast.database(t.projectId).collection("stocks").getAll(null,{cacheEnable:!1,dtl:0})];case 4:(o=a.sent()).forEach((function(t){return e[t.category]=t.category})),Object.keys(e).forEach((function(t){r.push({x:t,y:o.filter((function(e){return e.category===t})).length})})),a.label=5;case 5:return[2,r]}}))}))},t.\u0275fac=function(e){return new(e||t)(i.Wb(w.a),i.Wb(f.a),i.Wb(C.a))},t.\u0275prov=i.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),j=o("tyNb"),B=o("dNgK"),x=o("Wp6s"),E=o("kmnG"),O=o("qFsG"),L=o("bTqV"),N=o("STbY"),T=o("NFeN"),_=o("ZBrE"),I=o("FKr1"),A=o("Qu3c");function M(t,e){if(1&t&&i.Nb(0,"smartstock-data-not-ready",10),2&t){var o=i.dc();i.jc("isLoading",o.isLoading)}}function Q(t,e){1&t&&(i.Sb(0,"th",21),i.Ec(1,"Product"),i.Rb())}function q(t,e){if(1&t&&(i.Sb(0,"td",22),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.product)}}function $(t,e){1&t&&(i.Sb(0,"th",21),i.Ec(1,"Quantity"),i.Rb())}function V(t,e){if(1&t&&(i.Sb(0,"td",22),i.Ec(1),i.ec(2,"number"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.fc(2,1,o.quantity))}}function G(t,e){1&t&&(i.Sb(0,"th",21),i.Ec(1,"Reorder level"),i.Rb())}function z(t,e){if(1&t&&(i.Sb(0,"td",22),i.Ec(1),i.ec(2,"number"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.fc(2,1,o.reorder))}}function H(t,e){1&t&&(i.Sb(0,"th",21),i.Ec(1,"Supplier"),i.Rb())}function J(t,e){if(1&t&&(i.Sb(0,"td",23),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.supplier)}}function Z(t,e){1&t&&i.Nb(0,"tr",24)}function W(t,e){1&t&&i.Nb(0,"tr",25),2&t&&i.kc("matTooltip",e.$implicit.product)}function U(t,e){if(1&t&&(i.Sb(0,"div"),i.Sb(1,"table",11),i.Qb(2,12),i.Cc(3,Q,2,0,"th",13),i.Cc(4,q,2,1,"td",14),i.Pb(),i.Qb(5,15),i.Cc(6,$,2,0,"th",13),i.Cc(7,V,3,3,"td",14),i.Pb(),i.Qb(8,16),i.Cc(9,G,2,0,"th",13),i.Cc(10,z,3,3,"td",14),i.Pb(),i.Qb(11,17),i.Cc(12,H,2,0,"th",13),i.Cc(13,J,2,1,"td",18),i.Pb(),i.Cc(14,Z,1,0,"tr",19),i.Cc(15,W,1,1,"tr",20),i.Rb(),i.Rb()),2&t){var o=i.dc();i.Bb(1),i.jc("dataSource",o.stockReorderDatasource),i.Bb(13),i.jc("matHeaderRowDef",o.stockColumns),i.Bb(1),i.jc("matRowDefColumns",o.stockColumns)}}var K=function(){return[5,20,100]},X=function(){function t(t,e,o,r,a){this.router=t,this.indexDb=e,this.snack=o,this.logger=r,this.reportService=a,this.stockFetchProgress=!1,this.startDateFormControl=new b.f("",[b.v.nullValidator]),this.endDateFormControl=new b.f("",[b.v.nullValidator]),this.filterFormControl=new b.f("",[b.v.nullValidator]),this.stockReportGetProgress=!1,this.isLoading=!1,this.noDataRetrieved=!0,this.hotReloadProgress=!1,this.totalPurchase=Object(p.a)(0),this.stockColumns=["product","quantity","reorder","supplier"]}return t.prototype.ngOnInit=function(){var t=this;this._getStockReport(),this.filterFormControl.valueChanges.subscribe((function(e){t.stockReorderDatasource.filter=e.trim().toLowerCase()}))},t.prototype._getStockReport=function(){var t=this;this.isLoading=!0,this.stockReportGetProgress=!0,this.reportService.getStockReorderReportReport(0,1e3).then((function(e){t.stockReport=e.length>0?e[0].total:0,t.isLoading=!1,e&&Array.isArray(e)&&e.length>0?(t.stockReorderDatasource=new d.o(e),t.stockReorderDatasource.paginator=t.paginator,t.stockReorderDatasource.sort=t.sort,t.stockReportGetProgress=!1,t.noDataRetrieved=!1):t.noDataRetrieved=!0})).catch((function(e){t.isLoading=!1,t.stockReport=0,console.log(e),t.snack.open("Fails to get total sales","Ok",{duration:3e3}),t.stockReportGetProgress=!1}))},t.prototype.exportReport=function(){R(this.stockColumns,this.stockReorderDatasource.filteredData).then(console.log)},t.\u0275fac=function(e){return new(e||t)(i.Mb(j.b),i.Mb(f.a),i.Mb(B.a),i.Mb(m.a),i.Mb(F))},t.\u0275cmp=i.Gb({type:t,selectors:[["smartstock-stock-reorder-report"]],viewQuery:function(t,e){var o;1&t&&(i.Jc(h.a,!0),i.Jc(g.a,!0)),2&t&&(i.oc(o=i.ac())&&(e.paginator=o.first),i.oc(o=i.ac())&&(e.sort=o.first))},features:[i.Ab([v.a])],decls:20,vars:6,consts:[[1,"mat-elevation-z3"],[2,"display","flex","flex-flow","row","align-items","center"],[2,"flex-grow","1"],["matInput","","placeholder","Eg. Piriton",3,"formControl"],["mat-icon-button","",3,"mat-menu-trigger-for"],[3,"isLoading",4,"ngIf"],[4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],["exportMenu",""],["mat-menu-item","",3,"click"],[3,"isLoading"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","quantity"],["matColumnDef","reorder"],["matColumnDef","supplier"],["matRipple","","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["matRipple","","mat-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"]],template:function(t,e){if(1&t&&(i.Sb(0,"div"),i.Sb(1,"mat-card",0),i.Sb(2,"div",1),i.Sb(3,"h6"),i.Ec(4,"StockModel Reorder"),i.Rb(),i.Nb(5,"span",2),i.Sb(6,"mat-form-field"),i.Sb(7,"mat-label"),i.Ec(8,"Filter"),i.Rb(),i.Nb(9,"input",3),i.Rb(),i.Sb(10,"button",4),i.Sb(11,"mat-icon"),i.Ec(12,"more_vert"),i.Rb(),i.Rb(),i.Rb(),i.Cc(13,M,1,1,"smartstock-data-not-ready",5),i.Cc(14,U,16,3,"div",6),i.Nb(15,"mat-paginator",7),i.Rb(),i.Rb(),i.Sb(16,"mat-menu",null,8),i.Sb(18,"button",9),i.Zb("click",(function(){return e.exportReport()})),i.Ec(19," Export"),i.Rb(),i.Rb()),2&t){var o=i.pc(17);i.Bb(9),i.jc("formControl",e.filterFormControl),i.Bb(1),i.jc("mat-menu-trigger-for",o),i.Bb(3),i.jc("ngIf",e.noDataRetrieved||e.isLoading),i.Bb(1),i.jc("ngIf",!e.noDataRetrieved&&!e.isLoading),i.Bb(1),i.jc("pageSizeOptions",i.lc(5,K))}},directives:[x.a,E.c,E.f,O.b,b.c,b.o,b.g,L.a,N.d,T.a,r.n,h.a,N.e,N.b,_.a,d.n,g.a,d.c,d.i,d.b,d.k,d.m,d.h,g.b,d.a,I.s,d.j,d.l,A.a],pipes:[r.g],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),t}();function Y(t,e){if(1&t&&i.Nb(0,"smartstock-data-not-ready",11),2&t){var o=i.dc();i.jc("isLoading",o.isLoading)}}function tt(t,e){1&t&&(i.Sb(0,"th",19),i.Ec(1,"Product"),i.Rb())}function et(t,e){if(1&t&&(i.Sb(0,"td",20),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.product)}}function ot(t,e){1&t&&(i.Sb(0,"th",19),i.Ec(1,"Expiry Date"),i.Rb())}function rt(t,e){if(1&t&&(i.Sb(0,"td",20),i.Ec(1),i.ec(2,"date"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.fc(2,1,o.expire))}}function at(t,e){1&t&&i.Nb(0,"tr",21)}function nt(t,e){1&t&&i.Nb(0,"tr",22),2&t&&i.kc("matTooltip",e.$implicit.product)}function ct(t,e){if(1&t&&(i.Sb(0,"table",12),i.Qb(1,13),i.Cc(2,tt,2,0,"th",14),i.Cc(3,et,2,1,"td",15),i.Pb(),i.Qb(4,16),i.Cc(5,ot,2,0,"th",14),i.Cc(6,rt,3,3,"td",15),i.Pb(),i.Cc(7,at,1,0,"tr",17),i.Cc(8,nt,1,1,"tr",18),i.Rb()),2&t){var o=i.dc();i.jc("dataSource",o.expiredProducts),i.Bb(7),i.jc("matHeaderRowDef",o.stockColumns),i.Bb(1),i.jc("matRowDefColumns",o.stockColumns)}}var it=function(){return[5,20,100]},st=function(){function t(t,e){this.report=t,this.snack=e,this.isLoading=!1,this.noDataRetrieved=!0,this.stockColumns=["product","expire"],this.filterFormControl=new b.f("",[b.v.nullValidator])}return t.prototype.ngOnInit=function(){var t=this;this.isLoading=!0,this.report.getExpiredProducts(new Date,0,1e3).then((function(e){t.isLoading=!1,e&&Array.isArray(e)&&e.length>0?(t.expiredProducts=new d.o(e),t.expiredProducts.paginator=t.paginator,t.expiredProducts.sort=t.sort,t.noDataRetrieved=!1):t.noDataRetrieved=!0})).catch((function(e){t.isLoading=!1,console.log(e),t.snack.open("Fails to get total expired products","Ok",{duration:3e3})})),this.filterFormControl.valueChanges.subscribe((function(e){t.expiredProducts.filter=e.trim().toLowerCase()}))},t.prototype.exportReport=function(){R(this.stockColumns,this.expiredProducts.filteredData).then(console.log)},t.\u0275fac=function(e){return new(e||t)(i.Mb(F),i.Mb(B.a))},t.\u0275cmp=i.Gb({type:t,selectors:[["smartstock-expired-products-report"]],viewQuery:function(t,e){var o;1&t&&(i.Jc(h.a,!0),i.Jc(g.a,!0)),2&t&&(i.oc(o=i.ac())&&(e.paginator=o.first),i.oc(o=i.ac())&&(e.sort=o.first))},features:[i.Ab([F])],decls:20,vars:6,consts:[[1,"mat-elevation-z3"],[2,"display","flex","flex-flow","row","align-items","center","margin-right","100px"],[1,"col-8"],[2,"flex-grow","1"],["matInput","","placeholder","Eg. Piriton",3,"formControl"],["mat-icon-button","",3,"mat-menu-trigger-for"],[3,"isLoading",4,"ngIf"],["mat-table","","matSort","",3,"dataSource",4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],["exportMenu",""],["mat-menu-item","",3,"click"],[3,"isLoading"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","expire"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"]],template:function(t,e){if(1&t&&(i.Sb(0,"div"),i.Sb(1,"mat-card",0),i.Sb(2,"div",1),i.Sb(3,"h6",2),i.Ec(4,"Expired"),i.Rb(),i.Nb(5,"span",3),i.Sb(6,"mat-form-field"),i.Sb(7,"mat-label"),i.Ec(8,"Filter"),i.Rb(),i.Nb(9,"input",4),i.Rb(),i.Sb(10,"button",5),i.Sb(11,"mat-icon"),i.Ec(12,"more_vert"),i.Rb(),i.Rb(),i.Rb(),i.Cc(13,Y,1,1,"smartstock-data-not-ready",6),i.Cc(14,ct,9,3,"table",7),i.Nb(15,"mat-paginator",8),i.Rb(),i.Rb(),i.Sb(16,"mat-menu",null,9),i.Sb(18,"button",10),i.Zb("click",(function(){return e.exportReport()})),i.Ec(19," Export"),i.Rb(),i.Rb()),2&t){var o=i.pc(17);i.Bb(9),i.jc("formControl",e.filterFormControl),i.Bb(1),i.jc("mat-menu-trigger-for",o),i.Bb(3),i.jc("ngIf",e.noDataRetrieved||e.isLoading),i.Bb(1),i.jc("ngIf",!e.noDataRetrieved&&!e.isLoading),i.Bb(1),i.jc("pageSizeOptions",i.lc(5,it))}},directives:[x.a,E.c,E.f,O.b,b.c,b.o,b.g,L.a,N.d,T.a,r.n,h.a,N.e,N.b,_.a,d.n,g.a,d.c,d.i,d.b,d.k,d.m,d.h,g.b,d.a,d.j,d.l,A.a],pipes:[r.f],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),t}();function lt(t,e){if(1&t&&i.Nb(0,"smartstock-data-not-ready",10),2&t){var o=i.dc();i.jc("isLoading",o.isLoading)}}function ut(t,e){1&t&&(i.Sb(0,"th",19),i.Ec(1,"Product"),i.Rb())}function dt(t,e){if(1&t&&(i.Sb(0,"td",20),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.product)}}function bt(t,e){1&t&&(i.Sb(0,"th",19),i.Ec(1,"Expiry Date"),i.Rb())}function ft(t,e){if(1&t&&(i.Sb(0,"td",20),i.Ec(1),i.ec(2,"date"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.fc(2,1,o.expire))}}function mt(t,e){1&t&&(i.Sb(0,"th",19),i.Ec(1,"Quantity Remaining"),i.Rb())}function pt(t,e){if(1&t&&(i.Sb(0,"td",20),i.Ec(1),i.ec(2,"number"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.fc(2,1,o.quantity))}}function ht(t,e){1&t&&i.Nb(0,"tr",21)}function gt(t,e){1&t&&i.Nb(0,"tr",22),2&t&&i.kc("matTooltip",e.$implicit.product)}function vt(t,e){if(1&t&&(i.Sb(0,"table",11),i.Qb(1,12),i.Cc(2,ut,2,0,"th",13),i.Cc(3,dt,2,1,"td",14),i.Pb(),i.Qb(4,15),i.Cc(5,bt,2,0,"th",13),i.Cc(6,ft,3,3,"td",14),i.Pb(),i.Qb(7,16),i.Cc(8,mt,2,0,"th",13),i.Cc(9,pt,3,3,"td",14),i.Pb(),i.Cc(10,ht,1,0,"tr",17),i.Cc(11,gt,1,1,"tr",18),i.Rb()),2&t){var o=i.dc();i.jc("dataSource",o.expiredProducts),i.Bb(10),i.jc("matHeaderRowDef",o.stockColumns),i.Bb(1),i.jc("matRowDefColumns",o.stockColumns)}}var Rt,Ct=function(){return[5,20,100]},St=function(){function t(t,e){this.report=t,this.snack=e,this.isLoading=!1,this.noDataRetrieved=!0,this.stocks=[],this.stockColumns=["product","expire","quantity"],this.filterFormControl=new b.f("",[b.v.nullValidator])}return t.prototype.ngOnInit=function(){var t=this;this.isLoading=!0,this.report.getProductsAboutToExpire().then((function(e){t.isLoading=!1,e&&Array.isArray(e)&&e.length>0?(t.expiredProducts=new d.o(e),t.expiredProducts.paginator=t.paginator,t.stocks=e,t.expiredProducts.sort=t.sort,t.noDataRetrieved=!1):t.noDataRetrieved=!0})).catch((function(e){t.isLoading=!1,console.log(e),t.snack.open("Fails to get total expired products","Ok",{duration:3e3})})),this.filterFormControl.valueChanges.subscribe((function(e){t.expiredProducts.filter=e.trim().toLowerCase()}))},t.prototype.exportReport=function(){R(this.stockColumns,this.expiredProducts.filteredData).then(console.log)},t.\u0275fac=function(e){return new(e||t)(i.Mb(F),i.Mb(B.a))},t.\u0275cmp=i.Gb({type:t,selectors:[["smartstock-products-about-to-expire"]],viewQuery:function(t,e){var o;1&t&&(i.Jc(h.a,!0),i.Jc(g.a,!0)),2&t&&(i.oc(o=i.ac())&&(e.paginator=o.first),i.oc(o=i.ac())&&(e.sort=o.first))},features:[i.Ab([F])],decls:19,vars:6,consts:[[1,"mat-elevation-z3"],[2,"display","flex","flex-wrap","wrap","flex-flow","row","align-items","center","margin-right","100px"],[1,"col-8"],["matInput","","placeholder","Eg. Piriton",3,"formControl"],["mat-icon-button","",3,"mat-menu-trigger-for"],[3,"isLoading",4,"ngIf"],["mat-table","","matSort","",3,"dataSource",4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],["exportMenu",""],["mat-menu-item","",3,"click"],[3,"isLoading"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","expire"],["matColumnDef","quantity"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"]],template:function(t,e){if(1&t&&(i.Sb(0,"div"),i.Sb(1,"mat-card",0),i.Sb(2,"div",1),i.Sb(3,"h6",2),i.Ec(4,"Near to Expire"),i.Rb(),i.Sb(5,"mat-form-field"),i.Sb(6,"mat-label"),i.Ec(7,"Filter"),i.Rb(),i.Nb(8,"input",3),i.Rb(),i.Sb(9,"button",4),i.Sb(10,"mat-icon"),i.Ec(11,"more_vert"),i.Rb(),i.Rb(),i.Rb(),i.Cc(12,lt,1,1,"smartstock-data-not-ready",5),i.Cc(13,vt,12,3,"table",6),i.Nb(14,"mat-paginator",7),i.Rb(),i.Rb(),i.Sb(15,"mat-menu",null,8),i.Sb(17,"button",9),i.Zb("click",(function(){return e.exportReport()})),i.Ec(18," Export"),i.Rb(),i.Rb()),2&t){var o=i.pc(16);i.Bb(8),i.jc("formControl",e.filterFormControl),i.Bb(1),i.jc("mat-menu-trigger-for",o),i.Bb(3),i.jc("ngIf",e.noDataRetrieved||e.isLoading),i.Bb(1),i.jc("ngIf",!e.noDataRetrieved&&!e.isLoading),i.Bb(1),i.jc("pageSizeOptions",i.lc(5,Ct))}},directives:[x.a,E.c,E.f,O.b,b.c,b.o,b.g,L.a,N.d,T.a,r.n,h.a,N.e,N.b,_.a,d.n,g.a,d.c,d.i,d.b,d.k,d.m,d.h,g.b,d.a,d.j,d.l,A.a],pipes:[r.f,r.g],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),t}(),yt=(Rt=function(t,e){return(Rt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}Rt(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),Dt=function(t){return{padding:t}},wt=function(t){function e(){var e=t.call(this)||this;return e.isMobile=n.a.android,e}return yt(e,t),e.prototype.ngOnInit=function(){},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Gb({type:e,selectors:[["smartstock-stock-reports"]],features:[i.yb],decls:17,vars:10,consts:[[1,"my-drawer-container"],[1,"match-parent-side",3,"fixedInViewport","mode","opened"],["sidenav",""],[3,"heading","sidenav","showProgress"],[3,"ngStyle","ngClass"],[1,"col-12","col-lg-10","col-xl-10","offset-xl-1","offset-lg-1","offset-md-0","offset-sm-0"],[1,"row"],[1,"col-12",2,"margin-bottom","10px"],[1,"col-xl-6","col-lg-6","col-md-6","col-sm-12","col-12",2,"margin-bottom","10px"]],template:function(t,e){if(1&t&&(i.Sb(0,"div"),i.Sb(1,"mat-sidenav-container",0),i.Sb(2,"mat-sidenav",1,2),i.Nb(4,"smartstock-admin-drawer"),i.Rb(),i.Sb(5,"mat-sidenav-content"),i.Nb(6,"smartstock-toolbar",3),i.Sb(7,"div",4),i.Sb(8,"div",5),i.Sb(9,"div",6),i.Sb(10,"div",7),i.Nb(11,"smartstock-stock-reorder-report"),i.Rb(),i.Rb(),i.Sb(12,"div",6),i.Sb(13,"div",8),i.Nb(14,"smartstock-expired-products-report"),i.Rb(),i.Sb(15,"div",8),i.Nb(16,"smartstock-products-about-to-expire"),i.Rb(),i.Rb(),i.Rb(),i.Rb(),i.Rb(),i.Rb(),i.Rb()),2&t){var o=i.pc(3);i.Bb(2),i.jc("fixedInViewport",!0)("mode",e.enoughWidth()?"side":"over")("opened",e.enoughWidth()),i.Bb(4),i.jc("heading","REPORT")("sidenav",o)("showProgress",!1),i.Bb(1),i.jc("ngStyle",i.mc(8,Dt,e.isMobile||!e.enoughWidth()?"24px 0":"24px 16px"))("ngClass",e.isMobile||!e.enoughWidth()?"container-fluid":"container")}},directives:[s.b,s.a,l.a,s.c,u.a,r.o,r.l,X,st,St],styles:[""]}),e}(c.a),kt=o("Xa2L"),Pt=o("d3UM"),Ft=o("nJc8"),jt=o("f0Cb"),Bt=o("XoyV"),xt=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();function Et(t,e){if(1&t&&i.Nb(0,"smartstock-data-not-ready",12),2&t){var o=i.dc();i.jc("isLoading",o.isLoading)}}function Ot(t,e){1&t&&(i.Sb(0,"th",25),i.Ec(1,"Category"),i.Rb())}function Lt(t,e){if(1&t&&(i.Sb(0,"td",26),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o._id)}}function Nt(t,e){1&t&&i.Nb(0,"td",27)}function Tt(t,e){1&t&&(i.Sb(0,"th",25),i.Ec(1,"Quantity sold"),i.Rb())}function _t(t,e){if(1&t&&(i.Sb(0,"td",26),i.Ec(1),i.ec(2,"number"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.fc(2,1,o.quantitySold))}}function It(t,e){1&t&&i.Nb(0,"td",27)}function At(t,e){1&t&&(i.Sb(0,"th",25),i.Ec(1,"Sales"),i.Rb())}function Mt(t,e){if(1&t&&(i.Sb(0,"td",26),i.Ec(1),i.ec(2,"currency"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.gc(2,1,o.sales,"TZS "))}}function Qt(t,e){1&t&&i.Nb(0,"td",27)}function qt(t,e){1&t&&(i.Sb(0,"th",25),i.Ec(1,"First sold"),i.Rb())}function $t(t,e){if(1&t&&(i.Sb(0,"td",26),i.Ec(1),i.ec(2,"date"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.fc(2,1,o.firstSold))}}function Vt(t,e){1&t&&i.Nb(0,"td",27)}function Gt(t,e){1&t&&(i.Sb(0,"th",25),i.Ec(1,"Last sold"),i.Rb())}function zt(t,e){if(1&t&&(i.Sb(0,"td",28),i.Ec(1),i.ec(2,"date"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.fc(2,1,o.lastSold))}}function Ht(t,e){1&t&&i.Nb(0,"td",27)}function Jt(t,e){1&t&&i.Nb(0,"tr",29)}function Zt(t,e){1&t&&i.Nb(0,"tr",30),2&t&&i.kc("matTooltip",e.$implicit.product)}function Wt(t,e){if(1&t&&(i.Sb(0,"div"),i.Sb(1,"table",13),i.Qb(2,14),i.Cc(3,Ot,2,0,"th",15),i.Cc(4,Lt,2,1,"td",16),i.Cc(5,Nt,1,0,"td",17),i.Pb(),i.Qb(6,18),i.Cc(7,Tt,2,0,"th",15),i.Cc(8,_t,3,3,"td",16),i.Cc(9,It,1,0,"td",17),i.Pb(),i.Qb(10,19),i.Cc(11,At,2,0,"th",15),i.Cc(12,Mt,3,4,"td",16),i.Cc(13,Qt,1,0,"td",17),i.Pb(),i.Qb(14,20),i.Cc(15,qt,2,0,"th",15),i.Cc(16,$t,3,3,"td",16),i.Cc(17,Vt,1,0,"td",17),i.Pb(),i.Qb(18,21),i.Cc(19,Gt,2,0,"th",15),i.Cc(20,zt,3,3,"td",22),i.Cc(21,Ht,1,0,"td",17),i.Pb(),i.Cc(22,Jt,1,0,"tr",23),i.Cc(23,Zt,1,1,"tr",24),i.Rb(),i.Rb()),2&t){var o=i.dc();i.Bb(1),i.jc("dataSource",o.productPerformanceDatasource),i.Bb(21),i.jc("matHeaderRowDef",o.stockColumns),i.Bb(1),i.jc("matRowDefColumns",o.stockColumns)}}var Ut=function(){return[10,20,100]},Kt=function(t){function e(e,o,r,a,n){var c=t.call(this)||this;return c.router=e,c.storageService=o,c.snack=r,c.logService=a,c.reportService=n,c.productPerformanceFetchProgress=!1,c.startDateFormControl=new b.f(Date.now().toString(),[b.v.nullValidator]),c.endDateFormControl=new b.f(Date.now().toString(),[b.v.nullValidator]),c.channelFormControl=new b.f("retail",[b.v.nullValidator]),c.filterFormControl=new b.f("",[b.v.nullValidator]),c.channel="retail",c.isLoading=!1,c.noDataRetrieved=!0,c.hotReloadProgress=!1,c.totalPurchase=Object(p.a)(0),c.productPerformanceDatasource=new d.o([]),c.stockColumns=["category","sales","quantitySold","firstSold","lastSold"],c}return xt(e,t),e.prototype.ngOnInit=function(){var t=this;this.productPerformanceDatasource.sort=this.sort,this.channelFormControl.setValue("retail"),this.startDate=Object(D.a)(new Date),this.endDate=Object(D.a)(new Date),this._getProductReport(this.channel,this.startDate,this.endDate),this._dateRangeListener(),this.filterFormControl.valueChanges.subscribe((function(e){t.productPerformanceDatasource.filter=e.trim().toLowerCase()}))},e.prototype._getProductReport=function(t,e,o){var r=this;this.isLoading=!0,this.productPerformanceFetchProgress=!0,this.reportService.getSalesByCategory(t,e,o).then((function(t){r.isLoading=!1,r.noDataRetrieved=!1,r.productPerformanceReport=t.length>0?t[0].total:0,r.productPerformanceDatasource.data=t,r.productPerformanceDatasource.paginator=r.paginator,r.productPerformanceDatasource.sort=r.sort,r.productPerformanceFetchProgress=!1})).catch((function(t){r.isLoading=!1,r.noDataRetrieved=!0,r.productPerformanceReport=0,r.snack.open("Fails to get product performance report","Ok",{duration:3e3}),r.productPerformanceFetchProgress=!1}))},e.prototype._dateRangeListener=function(){var t=this;this.startDateFormControl.valueChanges.subscribe((function(e){t.startDate=Object(D.a)(e),t._getProductReport(t.channel,t.startDate,t.endDate)})),this.endDateFormControl.valueChanges.subscribe((function(e){t.endDate=Object(D.a)(e),t._getProductReport(t.channel,t.startDate,t.endDate)})),this.channelFormControl.valueChanges.subscribe((function(e){t.channel=e,t._getProductReport(t.channel,t.startDate,t.endDate)}))},e.\u0275fac=function(t){return new(t||e)(i.Mb(j.b),i.Mb(f.a),i.Mb(B.a),i.Mb(m.a),i.Mb(F))},e.\u0275cmp=i.Gb({type:e,selectors:[["smartstock-profit-by-category"]],viewQuery:function(t,e){var o;1&t&&(i.Jc(h.a,!0),i.Jc(g.a,!0)),2&t&&(i.oc(o=i.ac())&&(e.paginator=o.first),i.oc(o=i.ac())&&(e.sort=o.first))},features:[i.yb],decls:28,vars:11,consts:[[1,"col-12"],[1,"mat-elevation-z3"],[2,"margin","0 4px"],["matInput","",3,"matDatepicker","formControl","click"],["matSuffix","",3,"for"],["startDatePicker",""],["endDatePicker",""],[2,"flex-grow","1"],["matInput","","placeholder","Eg. Piriton",3,"formControl"],[3,"isLoading",4,"ngIf"],[4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],[3,"isLoading"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","category"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","quantitySold"],["matColumnDef","sales"],["matColumnDef","firstSold"],["matColumnDef","lastSold"],["matRipple","","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell",""],["matRipple","","mat-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"]],template:function(t,e){if(1&t){var o=i.Tb();i.Sb(0,"div",0),i.Sb(1,"div"),i.Sb(2,"mat-card",1),i.Sb(3,"h6"),i.Ec(4,"Profit By Category"),i.Rb(),i.Sb(5,"mat-card-header"),i.Sb(6,"mat-form-field",2),i.Sb(7,"mat-label"),i.Ec(8,"From date"),i.Rb(),i.Sb(9,"input",3),i.Zb("click",(function(){return i.tc(o),i.pc(12).open()})),i.Rb(),i.Nb(10,"mat-datepicker-toggle",4),i.Nb(11,"mat-datepicker",null,5),i.Rb(),i.Sb(13,"mat-form-field",2),i.Sb(14,"mat-label"),i.Ec(15,"To date"),i.Rb(),i.Sb(16,"input",3),i.Zb("click",(function(){return i.tc(o),i.pc(19).open()})),i.Rb(),i.Nb(17,"mat-datepicker-toggle",4),i.Nb(18,"mat-datepicker",null,6),i.Rb(),i.Nb(20,"span",7),i.Sb(21,"mat-form-field"),i.Sb(22,"mat-label"),i.Ec(23,"Filter"),i.Rb(),i.Nb(24,"input",8),i.Rb(),i.Rb(),i.Cc(25,Et,1,1,"smartstock-data-not-ready",9),i.Cc(26,Wt,24,3,"div",10),i.Nb(27,"mat-paginator",11),i.Rb(),i.Rb(),i.Rb()}if(2&t){var r=i.pc(12),a=i.pc(19);i.Bb(9),i.jc("matDatepicker",r)("formControl",e.startDateFormControl),i.Bb(1),i.jc("for",r),i.Bb(6),i.jc("matDatepicker",a)("formControl",e.endDateFormControl),i.Bb(1),i.jc("for",a),i.Bb(7),i.jc("formControl",e.filterFormControl),i.Bb(1),i.jc("ngIf",e.noDataRetrieved||e.isLoading),i.Bb(1),i.jc("ngIf",!e.noDataRetrieved&&!e.isLoading),i.Bb(1),i.jc("pageSizeOptions",i.lc(10,Ut))}},directives:[x.a,x.d,E.c,E.f,O.b,a.b,b.c,b.o,b.g,a.d,E.h,a.a,r.n,h.a,_.a,d.n,g.a,d.c,d.i,d.b,d.e,d.k,d.m,d.h,g.b,d.a,d.d,I.s,d.j,d.l,A.a],pipes:[r.g,r.d,r.f],styles:[""]}),e}(c.a),Xt=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}();function Yt(t,e){if(1&t&&i.Nb(0,"smartstock-data-not-ready",12),2&t){var o=i.dc();i.jc("isLoading",o.isLoading)}}function te(t,e){1&t&&(i.Sb(0,"th",27),i.Ec(1,"Product"),i.Rb())}function ee(t,e){if(1&t&&(i.Sb(0,"td",28),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o._id)}}function oe(t,e){1&t&&i.Nb(0,"td",29)}function re(t,e){1&t&&(i.Sb(0,"th",27),i.Ec(1,"Category"),i.Rb())}function ae(t,e){if(1&t&&(i.Sb(0,"td",28),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.category)}}function ne(t,e){1&t&&i.Nb(0,"td",29)}function ce(t,e){1&t&&(i.Sb(0,"th",27),i.Ec(1,"Quantity sold"),i.Rb())}function ie(t,e){if(1&t&&(i.Sb(0,"td",28),i.Ec(1),i.ec(2,"number"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.fc(2,1,o.quantitySold))}}function se(t,e){1&t&&i.Nb(0,"td",29)}function le(t,e){1&t&&(i.Sb(0,"th",27),i.Ec(1,"First sold"),i.Rb())}function ue(t,e){if(1&t&&(i.Sb(0,"td",28),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.firstSold)}}function de(t,e){1&t&&i.Nb(0,"td",29)}function be(t,e){1&t&&(i.Sb(0,"th",27),i.Ec(1,"Last sold"),i.Rb())}function fe(t,e){if(1&t&&(i.Sb(0,"td",30),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.lastSold)}}function me(t,e){1&t&&i.Nb(0,"td",29)}function pe(t,e){1&t&&(i.Sb(0,"th",27),i.Ec(1,"Cost of goods sold"),i.Rb())}function he(t,e){if(1&t&&(i.Sb(0,"td",28),i.Ec(1),i.ec(2,"currency"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.gc(2,1,o.costOfGoodsSold," TZS"))}}function ge(t,e){1&t&&i.Nb(0,"td",29)}function ve(t,e){1&t&&(i.Sb(0,"th",27),i.Ec(1,"Gross profit"),i.Rb())}function Re(t,e){if(1&t&&(i.Sb(0,"td",28),i.Ec(1),i.ec(2,"currency"),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(i.gc(2,1,o.sales-o.costOfGoodsSold," TZS"))}}function Ce(t,e){1&t&&i.Nb(0,"td",29)}function Se(t,e){1&t&&i.Nb(0,"tr",31)}function ye(t,e){1&t&&i.Nb(0,"tr",32),2&t&&i.kc("matTooltip",e.$implicit.product)}function De(t,e){if(1&t&&(i.Sb(0,"div"),i.Sb(1,"table",13),i.Qb(2,14),i.Cc(3,te,2,0,"th",15),i.Cc(4,ee,2,1,"td",16),i.Cc(5,oe,1,0,"td",17),i.Pb(),i.Qb(6,18),i.Cc(7,re,2,0,"th",15),i.Cc(8,ae,2,1,"td",16),i.Cc(9,ne,1,0,"td",17),i.Pb(),i.Qb(10,19),i.Cc(11,ce,2,0,"th",15),i.Cc(12,ie,3,3,"td",16),i.Cc(13,se,1,0,"td",17),i.Pb(),i.Qb(14,20),i.Cc(15,le,2,0,"th",15),i.Cc(16,ue,2,1,"td",16),i.Cc(17,de,1,0,"td",17),i.Pb(),i.Qb(18,21),i.Cc(19,be,2,0,"th",15),i.Cc(20,fe,2,1,"td",22),i.Cc(21,me,1,0,"td",17),i.Pb(),i.Qb(22,23),i.Cc(23,pe,2,0,"th",15),i.Cc(24,he,3,4,"td",16),i.Cc(25,ge,1,0,"td",17),i.Pb(),i.Qb(26,24),i.Cc(27,ve,2,0,"th",15),i.Cc(28,Re,3,4,"td",16),i.Cc(29,Ce,1,0,"td",17),i.Pb(),i.Cc(30,Se,1,0,"tr",25),i.Cc(31,ye,1,1,"tr",26),i.Rb(),i.Rb()),2&t){var o=i.dc();i.Bb(1),i.jc("dataSource",o.productPerformanceDatasource),i.Bb(29),i.jc("matHeaderRowDef",o.stockColumns),i.Bb(1),i.jc("matRowDefColumns",o.stockColumns)}}var we=function(){return[10,20,100]},ke=function(t){function e(e,o,r,a,n){var c=t.call(this)||this;return c.router=e,c.indexDb=o,c.snack=r,c.logger=a,c._report=n,c.productPerformanceFetchProgress=!1,c.startDateFormControl=new b.f("",[b.v.nullValidator]),c.endDateFormControl=new b.f("",[b.v.nullValidator]),c.channelFormControl=new b.f("",[b.v.nullValidator]),c.filterFormControl=new b.f("",[b.v.nullValidator]),c.channel="retail",c.isLoading=!1,c.noDataRetrieved=!0,c.hotReloadProgress=!1,c.totalPurchase=Object(p.a)(0),c.stockColumns=["product","category","quantitySold","firstSold","lastSold","costOfGoodSold","grossProfit"],c}return Xt(e,t),e.prototype.ngOnInit=function(){var t=this;this.channelFormControl.setValue("retail"),this.startDate=Object(D.a)(new Date),this.endDate=Object(D.a)(new Date),this._getProductReport(this.channel,this.startDate,this.endDate),this._dateRangeListener(),this.filterFormControl.valueChanges.subscribe((function(e){t.productPerformanceDatasource.filter=e.trim().toLowerCase()}))},e.prototype._getProductReport=function(t,e,o){var r=this;this.isLoading=!0,this.productPerformanceFetchProgress=!0,this._report.getProductPerformanceReport(t,e,o).then((function(t){r.isLoading=!1,r.noDataRetrieved=!1,r.productPerformanceReport=t.length>0?t[0].total:0,r.productPerformanceDatasource=new d.o(t),r.productPerformanceDatasource.paginator=r.paginator,r.productPerformanceDatasource.sort=r.sort,r.productPerformanceFetchProgress=!1})).catch((function(t){r.isLoading=!1,r.noDataRetrieved=!0,r.productPerformanceReport=0,r.snack.open("Fails to get product performance report","Ok",{duration:3e3}),r.productPerformanceFetchProgress=!1}))},e.prototype._dateRangeListener=function(){var t=this;this.startDateFormControl.valueChanges.subscribe((function(e){t.startDate=Object(D.a)(e),t._getProductReport(t.channel,t.startDate,t.endDate)})),this.endDateFormControl.valueChanges.subscribe((function(e){t.endDate=Object(D.a)(e),t._getProductReport(t.channel,t.startDate,t.endDate)})),this.channelFormControl.valueChanges.subscribe((function(e){t.channel=e,t._getProductReport(t.channel,t.startDate,t.endDate)}))},e.\u0275fac=function(t){return new(t||e)(i.Mb(j.b),i.Mb(f.a),i.Mb(B.a),i.Mb(m.a),i.Mb(F))},e.\u0275cmp=i.Gb({type:e,selectors:[["smartstock-product-performance-report"]],viewQuery:function(t,e){var o;1&t&&(i.Jc(h.a,!0),i.Jc(g.a,!0)),2&t&&(i.oc(o=i.ac())&&(e.paginator=o.first),i.oc(o=i.ac())&&(e.sort=o.first))},features:[i.Ab([F]),i.yb],decls:28,vars:11,consts:[[1,"col-12"],[1,"mat-elevation-z3"],[2,"margin","0 4px"],["matInput","",3,"matDatepicker","formControl","click"],["matSuffix","",3,"for"],["startDatePicker",""],["endDatePicker",""],[2,"flex-grow","1"],["matInput","","placeholder","Eg. Piriton",3,"formControl"],[3,"isLoading",4,"ngIf"],[4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],[3,"isLoading"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","product"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","category"],["matColumnDef","quantitySold"],["matColumnDef","firstSold"],["matColumnDef","lastSold"],["matRipple","","mat-cell","",4,"matCellDef"],["matColumnDef","costOfGoodSold"],["matColumnDef","grossProfit"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell",""],["matRipple","","mat-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"]],template:function(t,e){if(1&t){var o=i.Tb();i.Sb(0,"div",0),i.Sb(1,"div"),i.Sb(2,"mat-card",1),i.Sb(3,"h6"),i.Ec(4,"Product Performance Report"),i.Rb(),i.Sb(5,"mat-card-header"),i.Sb(6,"mat-form-field",2),i.Sb(7,"mat-label"),i.Ec(8,"From date"),i.Rb(),i.Sb(9,"input",3),i.Zb("click",(function(){return i.tc(o),i.pc(12).open()})),i.Rb(),i.Nb(10,"mat-datepicker-toggle",4),i.Nb(11,"mat-datepicker",null,5),i.Rb(),i.Sb(13,"mat-form-field",2),i.Sb(14,"mat-label"),i.Ec(15,"To date"),i.Rb(),i.Sb(16,"input",3),i.Zb("click",(function(){return i.tc(o),i.pc(19).open()})),i.Rb(),i.Nb(17,"mat-datepicker-toggle",4),i.Nb(18,"mat-datepicker",null,6),i.Rb(),i.Nb(20,"span",7),i.Sb(21,"mat-form-field"),i.Sb(22,"mat-label"),i.Ec(23,"Filter"),i.Rb(),i.Nb(24,"input",8),i.Rb(),i.Rb(),i.Cc(25,Yt,1,1,"smartstock-data-not-ready",9),i.Cc(26,De,32,3,"div",10),i.Nb(27,"mat-paginator",11),i.Rb(),i.Rb(),i.Rb()}if(2&t){var r=i.pc(12),a=i.pc(19);i.Bb(9),i.jc("matDatepicker",r)("formControl",e.startDateFormControl),i.Bb(1),i.jc("for",r),i.Bb(6),i.jc("matDatepicker",a)("formControl",e.endDateFormControl),i.Bb(1),i.jc("for",a),i.Bb(7),i.jc("formControl",e.filterFormControl),i.Bb(1),i.jc("ngIf",e.noDataRetrieved||e.isLoading),i.Bb(1),i.jc("ngIf",!e.noDataRetrieved&&!e.isLoading),i.Bb(1),i.jc("pageSizeOptions",i.lc(10,we))}},directives:[x.a,x.d,E.c,E.f,O.b,a.b,b.c,b.o,b.g,a.d,E.h,a.a,r.n,h.a,_.a,d.n,g.a,d.c,d.i,d.b,d.e,d.k,d.m,d.h,g.b,d.a,d.d,d.j,d.l,A.a],pipes:[r.g,r.d],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),e}(c.a),Pe=o("6n/F");function Fe(t,e){1&t&&(i.Sb(0,"mat-icon"),i.Ec(1,"refresh"),i.Rb())}function je(t,e){1&t&&i.Nb(0,"mat-progress-spinner",18),2&t&&i.jc("diameter",15)}function Be(t,e){if(1&t&&i.Nb(0,"smartstock-data-not-ready",19),2&t){var o=i.dc();i.jc("isLoading",o.isLoading)}}var xe=function(){function t(t){this._report=t,this.salesTrendDayFromDateFormControl=new b.f,this.salesTrendDayToDateFormControl=new b.f,this.salesByDayTrendProgress=!1,this.trendChart=void 0,this.isLoading=!1,this.noDataRetrieved=!0}return t.prototype.ngOnInit=function(){var t=new Date,e=new Date((new Date).setDate(t.getDate()-7));this.salesTrendDayFromDateFormControl.setValue(e),this.salesTrendDayToDateFormControl.setValue(t),this._getSalesTrend(Object(D.a)(e),Object(D.a)(t)),this._listenForDateChange()},t.prototype._listenForDateChange=function(){var t=this;this.salesTrendDayFromDateFormControl.valueChanges.subscribe((function(e){t.refreshTrendReport()})),this.salesTrendDayToDateFormControl.valueChanges.subscribe((function(e){t.refreshTrendReport()}))},t.prototype._getSalesTrend=function(t,e){var o=this;this.isLoading=!0,this.salesByDayTrendProgress=!0,this._report.getSalesTrend(t,e).then((function(t){o.isLoading=!1,o.noDataRetrieved=!1,o.initiateGraph(t),o.salesByDayTrendProgress=!1})).catch((function(t){o.isLoading=!1,o.noDataRetrieved=!0,o.salesByDayTrendProgress=!1}))},t.prototype.initiateGraph=function(t){var e=[],o=[];Object.keys(t).forEach((function(r){e.push(t[r]._id),o.push(t[r].total)})),this.trendChart=Pe.chart("salesTrendByDay",{chart:{type:"areaspline"},title:{text:"Sales By Date"},xAxis:{categories:e,title:{text:"Day"},labels:{formatter:function(){return this.value}}},yAxis:{title:{text:"Total Sales"},labels:{formatter:function(){return this.value}}},tooltip:{},plotOptions:{area:{marker:{enabled:!1,symbol:"circle",radius:4,states:{hover:{enabled:!0}}}}},series:[{name:"Sales",color:"#0b2e13",data:o}]})},t.prototype.refreshTrendReport=function(){this._getSalesTrend(Object(D.a)(new Date(this.salesTrendDayFromDateFormControl.value)),Object(D.a)(new Date(this.salesTrendDayToDateFormControl.value)))},t.\u0275fac=function(e){return new(e||t)(i.Mb(v.a))},t.\u0275cmp=i.Gb({type:t,selectors:[["smartstock-dashboard-sale-trends"]],features:[i.Ab([v.a])],decls:29,vars:12,consts:[[1,"col-12",2,"margin-top","1em"],[1,"mat-elevation-z3"],[1,"d-flex","flex-row","flex-wrap","btn-block","align-items-center"],[1,"flex-grow-1"],["appearance","outline",2,"margin-right","8px"],["matInput","",3,"matDatepicker","formControl"],["matSuffix","",3,"for"],[3,"touchUi"],["pickerFromSaleTrendDay",""],["appearance","outline"],["pickerToSaleTrendDay",""],["mat-flat-button","","color","primary",1,"ft-button","dashboard-refresh-button",3,"disabled","click"],[4,"ngIf"],["style","display: inline-block","mode","indeterminate","color","primary",3,"diameter",4,"ngIf"],[1,"row"],[1,"col-12",2,"padding","8px"],["id","salesTrendByDay"],[3,"isLoading",4,"ngIf"],["mode","indeterminate","color","primary",2,"display","inline-block",3,"diameter"],[3,"isLoading"]],template:function(t,e){if(1&t&&(i.Sb(0,"div",0),i.Sb(1,"mat-card",1),i.Sb(2,"h6"),i.Ec(3,"Total Sales Report"),i.Rb(),i.Sb(4,"div",2),i.Nb(5,"span",3),i.Sb(6,"div"),i.Sb(7,"mat-form-field",4),i.Sb(8,"mat-label"),i.Ec(9,"From Date"),i.Rb(),i.Nb(10,"input",5),i.Nb(11,"mat-datepicker-toggle",6),i.Nb(12,"mat-datepicker",7,8),i.Rb(),i.Sb(14,"mat-form-field",9),i.Sb(15,"mat-label"),i.Ec(16,"To Date"),i.Rb(),i.Nb(17,"input",5),i.Nb(18,"mat-datepicker-toggle",6),i.Nb(19,"mat-datepicker",7,10),i.Rb(),i.Sb(21,"button",11),i.Zb("click",(function(){return e.refreshTrendReport()})),i.Cc(22,Fe,2,0,"mat-icon",12),i.Cc(23,je,1,1,"mat-progress-spinner",13),i.Rb(),i.Rb(),i.Rb(),i.Sb(24,"div",14),i.Sb(25,"div",15),i.Sb(26,"mat-card-content"),i.Nb(27,"div",16),i.Cc(28,Be,1,1,"smartstock-data-not-ready",17),i.Rb(),i.Rb(),i.Rb(),i.Rb(),i.Rb()),2&t){var o=i.pc(13),r=i.pc(20);i.Bb(10),i.jc("matDatepicker",o)("formControl",e.salesTrendDayFromDateFormControl),i.Bb(1),i.jc("for",o),i.Bb(1),i.jc("touchUi",!0),i.Bb(5),i.jc("matDatepicker",r)("formControl",e.salesTrendDayToDateFormControl),i.Bb(1),i.jc("for",r),i.Bb(1),i.jc("touchUi",!0),i.Bb(2),i.jc("disabled",e.salesByDayTrendProgress),i.Bb(1),i.jc("ngIf",!e.salesByDayTrendProgress),i.Bb(1),i.jc("ngIf",e.salesByDayTrendProgress),i.Bb(5),i.jc("ngIf",e.noDataRetrieved||e.isLoading)}},directives:[x.a,E.c,E.f,O.b,a.b,b.c,b.o,b.g,a.d,E.h,a.a,L.a,r.n,x.c,T.a,kt.a,_.a],styles:[""]}),t}();function Ee(t,e){1&t&&i.Nb(0,"mat-spinner")}function Oe(t,e){1&t&&i.Nb(0,"smartstock-data-not-ready")}function Le(t,e){1&t&&(i.Sb(0,"th",30),i.Ec(1,"Cart Receipt"),i.Rb())}function Ne(t,e){if(1&t&&(i.Sb(0,"td",31),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o._id)}}function Te(t,e){1&t&&i.Nb(0,"td",32)}function _e(t,e){1&t&&(i.Sb(0,"th",30),i.Ec(1,"Total Amount"),i.Rb())}function Ie(t,e){if(1&t&&(i.Sb(0,"td",31),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.amount)}}function Ae(t,e){1&t&&i.Nb(0,"td",32)}function Me(t,e){1&t&&(i.Sb(0,"th",30),i.Ec(1,"Total Items"),i.Rb())}function Qe(t,e){if(1&t&&(i.Sb(0,"td",31),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.quantity)}}function qe(t,e){1&t&&i.Nb(0,"td",32)}function $e(t,e){1&t&&(i.Sb(0,"th",30),i.Ec(1,"Seller"),i.Rb())}function Ve(t,e){if(1&t&&(i.Sb(0,"td",31),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.seller)}}function Ge(t,e){1&t&&i.Nb(0,"td",32)}function ze(t,e){1&t&&(i.Sb(0,"th",30),i.Ec(1,"Date Sold"),i.Rb())}function He(t,e){if(1&t&&(i.Sb(0,"td",31),i.Ec(1),i.Rb()),2&t){var o=e.$implicit;i.Bb(1),i.Fc(o.date)}}function Je(t,e){1&t&&i.Nb(0,"td",32)}function Ze(t,e){1&t&&i.Nb(0,"tr",33)}function We(t,e){1&t&&i.Nb(0,"tr",34),2&t&&i.kc("matTooltip",e.$implicit.product)}function Ue(t,e){1&t&&i.Nb(0,"tr",35)}function Ke(t,e){if(1&t&&(i.Sb(0,"table",18),i.Qb(1,19),i.Cc(2,Le,2,0,"th",20),i.Cc(3,Ne,2,1,"td",21),i.Cc(4,Te,1,0,"td",22),i.Pb(),i.Qb(5,23),i.Cc(6,_e,2,0,"th",20),i.Cc(7,Ie,2,1,"td",21),i.Cc(8,Ae,1,0,"td",22),i.Pb(),i.Qb(9,24),i.Cc(10,Me,2,0,"th",20),i.Cc(11,Qe,2,1,"td",21),i.Cc(12,qe,1,0,"td",22),i.Pb(),i.Qb(13,25),i.Cc(14,$e,2,0,"th",20),i.Cc(15,Ve,2,1,"td",21),i.Cc(16,Ge,1,0,"td",22),i.Pb(),i.Qb(17,26),i.Cc(18,ze,2,0,"th",20),i.Cc(19,He,2,1,"td",21),i.Cc(20,Je,1,0,"td",22),i.Pb(),i.Cc(21,Ze,1,0,"tr",27),i.Cc(22,We,1,1,"tr",28),i.Cc(23,Ue,1,0,"tr",29),i.Rb()),2&t){var o=i.dc();i.jc("dataSource",o.carts),i.Bb(21),i.jc("matHeaderRowDef",o.cartColumns),i.Bb(1),i.jc("matRowDefColumns",o.cartColumns),i.Bb(1),i.jc("matFooterRowDef",o.cartColumns)}}var Xe=function(){return[10,20,100]},Ye=function(){function t(t,e){this.report=t,this.snack=e,this.channel="retail",this.isLoading=!1,this.noDataRetrieved=!0,this.stocks=[],this.cartColumns=["receipt","total_amount","total_items","seller","date"],this.startDateFormControl=new b.f("",[b.v.nullValidator]),this.endDateFormControl=new b.f("",[b.v.nullValidator]),this.channelFormControl=new b.f("",[b.v.nullValidator]),this.filterFormControl=new b.f("",[b.v.nullValidator])}return t.prototype.ngOnInit=function(){var t=this;this.channelFormControl.setValue("retail"),this.startDate=Object(D.a)(new Date),this.endDate=Object(D.a)(new Date),this.getSoldCarts(this.startDate,this.endDate,this.channel),this._dateRangeListener(),this.filterFormControl.valueChanges.subscribe((function(e){t.carts.filter=e.trim().toLowerCase()}))},t.prototype.getSoldCarts=function(t,e,o){var r=this;this.isLoading=!0,this.report.getSoldCarts(e,o,t).then((function(t){r.isLoading=!1,t&&Array.isArray(t)&&t.length>0?(r.carts=new d.o(t),r.carts.paginator=r.paginator,r.stocks=t,r.carts.sort=r.sort,r.noDataRetrieved=!1):r.noDataRetrieved=!0})).catch((function(t){r.isLoading=!1,r.snack.open("Fails to get total expired products","Ok",{duration:3e3})}))},t.prototype.exportReport=function(){R(this.cartColumns,this.carts.filteredData).then(console.log)},t.prototype._dateRangeListener=function(){var t=this;this.startDateFormControl.valueChanges.subscribe((function(e){t.startDate=Object(D.a)(e),t.getSoldCarts(t.channel,t.startDate,t.endDate)})),this.endDateFormControl.valueChanges.subscribe((function(e){t.endDate=Object(D.a)(e),t.getSoldCarts(t.channel,t.startDate,t.endDate)})),this.channelFormControl.valueChanges.subscribe((function(e){t.channel=e,t.getSoldCarts(t.channel,t.startDate,t.endDate)}))},t.\u0275fac=function(e){return new(e||t)(i.Mb(F),i.Mb(B.a))},t.\u0275cmp=i.Gb({type:t,selectors:[["smartstock-cart-report"]],viewQuery:function(t,e){var o;1&t&&(i.Jc(h.a,!0),i.Jc(g.a,!0)),2&t&&(i.oc(o=i.ac())&&(e.paginator=o.first),i.oc(o=i.ac())&&(e.sort=o.first))},features:[i.Ab([F])],decls:39,vars:13,consts:[[1,"col-12",2,"margin-top","1em"],[1,"mat-elevation-z3"],[2,"display","flex","flex-flow","row","align-items","center"],[1,"col-8"],[2,"flex-grow","1"],["mat-icon-button","",3,"mat-menu-trigger-for"],[2,"margin","0 4px"],["matInput","",3,"matDatepicker","formControl","click"],["matSuffix","",3,"for"],["startDatePicker",""],["endDatePicker",""],["matInput","","placeholder","Eg. Piriton",3,"formControl"],[2,"display","flex","justify-content","center"],[4,"ngIf"],["mat-table","","matSort","",3,"dataSource",4,"ngIf"],["showFirstLastButtons","",3,"pageSizeOptions"],["exportMenu",""],["mat-menu-item","",3,"click"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","receipt"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-footer-cell","",4,"matFooterCellDef"],["matColumnDef","total_amount"],["matColumnDef","total_items"],["matColumnDef","seller"],["matColumnDef","date"],["mat-header-row","",4,"matHeaderRowDef"],["class","table-data-row","mat-row","",3,"matTooltip",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","style","font-size: 36px",4,"matFooterRowDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-footer-cell",""],["mat-header-row",""],["mat-row","",1,"table-data-row",3,"matTooltip"],["mat-footer-row","",2,"font-size","36px"]],template:function(t,e){if(1&t){var o=i.Tb();i.Sb(0,"div",0),i.Sb(1,"div"),i.Sb(2,"mat-card",1),i.Sb(3,"div",2),i.Sb(4,"h6",3),i.Ec(5,"Cart Report"),i.Rb(),i.Nb(6,"span",4),i.Sb(7,"button",5),i.Sb(8,"mat-icon"),i.Ec(9,"more_vert"),i.Rb(),i.Rb(),i.Rb(),i.Sb(10,"mat-card-header"),i.Sb(11,"mat-form-field",6),i.Sb(12,"mat-label"),i.Ec(13,"From date"),i.Rb(),i.Sb(14,"input",7),i.Zb("click",(function(){return i.tc(o),i.pc(17).open()})),i.Rb(),i.Nb(15,"mat-datepicker-toggle",8),i.Nb(16,"mat-datepicker",null,9),i.Rb(),i.Sb(18,"mat-form-field",6),i.Sb(19,"mat-label"),i.Ec(20,"To date"),i.Rb(),i.Sb(21,"input",7),i.Zb("click",(function(){return i.tc(o),i.pc(24).open()})),i.Rb(),i.Nb(22,"mat-datepicker-toggle",8),i.Nb(23,"mat-datepicker",null,10),i.Rb(),i.Nb(25,"span",4),i.Sb(26,"mat-form-field"),i.Sb(27,"mat-label"),i.Ec(28,"Filter"),i.Rb(),i.Nb(29,"input",11),i.Rb(),i.Rb(),i.Sb(30,"div",12),i.Cc(31,Ee,1,0,"mat-spinner",13),i.Rb(),i.Cc(32,Oe,1,0,"smartstock-data-not-ready",13),i.Cc(33,Ke,24,4,"table",14),i.Nb(34,"mat-paginator",15),i.Rb(),i.Rb(),i.Rb(),i.Sb(35,"mat-menu",null,16),i.Sb(37,"button",17),i.Zb("click",(function(){return e.exportReport()})),i.Ec(38," Export"),i.Rb(),i.Rb()}if(2&t){var r=i.pc(17),a=i.pc(24),n=i.pc(36);i.Bb(7),i.jc("mat-menu-trigger-for",n),i.Bb(7),i.jc("matDatepicker",r)("formControl",e.startDateFormControl),i.Bb(1),i.jc("for",r),i.Bb(6),i.jc("matDatepicker",a)("formControl",e.endDateFormControl),i.Bb(1),i.jc("for",a),i.Bb(7),i.jc("formControl",e.filterFormControl),i.Bb(2),i.jc("ngIf",e.isLoading),i.Bb(1),i.jc("ngIf",e.noDataRetrieved&&!e.isLoading),i.Bb(1),i.jc("ngIf",!e.noDataRetrieved&&!e.isLoading),i.Bb(1),i.jc("pageSizeOptions",i.lc(12,Xe))}},directives:[x.a,L.a,N.d,T.a,x.d,E.c,E.f,O.b,a.b,b.c,b.o,b.g,a.d,E.h,a.a,r.n,h.a,N.e,N.b,kt.c,_.a,d.n,g.a,d.c,d.i,d.b,d.e,d.k,d.m,d.g,d.h,g.b,d.a,d.d,d.j,d.l,A.a,d.f],styles:["table[_ngcontent-%COMP%]{width:100%}"]}),t}(),to=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),eo=["sidenav"],oo=function(t){return{padding:t}},ro=function(t){function e(){var e=t.call(this)||this;return e.isMobile=n.a.android,e}return to(e,t),e.prototype.ngOnInit=function(){},e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Gb({type:e,selectors:[["smartstock-sales-reports"]],viewQuery:function(t,e){var o;1&t&&i.Jc(eo,!0),2&t&&i.oc(o=i.ac())&&(e.sidenav=o.first)},features:[i.yb],decls:18,vars:10,consts:[[1,"my-drawer-container"],[1,"match-parent-side",3,"fixedInViewport","mode","opened"],["sidenav",""],[3,"heading","sidenav","showProgress"],[3,"ngStyle","ngClass"],[1,"col-12","col-lg-10","col-xl-10","offset-xl-1","offset-lg-1","offset-md-0","offset-sm-0"],[1,"row"],[1,"col-12",2,"margin-bottom","10px"],[2,"margin-bottom","1em"]],template:function(t,e){if(1&t&&(i.Sb(0,"div"),i.Sb(1,"mat-sidenav-container",0),i.Sb(2,"mat-sidenav",1,2),i.Nb(4,"smartstock-admin-drawer"),i.Rb(),i.Sb(5,"mat-sidenav-content"),i.Nb(6,"smartstock-toolbar",3),i.Sb(7,"div",4),i.Sb(8,"div",5),i.Sb(9,"div",6),i.Sb(10,"div",7),i.Nb(11,"smartstock-profit-by-category",8),i.Rb(),i.Sb(12,"div",7),i.Nb(13,"smartstock-product-performance-report",8),i.Rb(),i.Sb(14,"div",7),i.Nb(15,"smartstock-dashboard-sale-trends"),i.Rb(),i.Sb(16,"div",7),i.Nb(17,"smartstock-cart-report"),i.Rb(),i.Rb(),i.Rb(),i.Rb(),i.Rb(),i.Rb(),i.Rb()),2&t){var o=i.pc(3);i.Bb(2),i.jc("fixedInViewport",!0)("mode",e.enoughWidth()?"side":"over")("opened",e.enoughWidth()),i.Bb(4),i.jc("heading","REPORT")("sidenav",o)("showProgress",!1),i.Bb(1),i.jc("ngStyle",i.mc(8,oo,e.isMobile||!e.enoughWidth()?"24px 0":"40px 16px"))("ngClass",e.isMobile||!e.enoughWidth()?"container-fluid":"container")}},directives:[s.b,s.a,l.a,s.c,u.a,r.o,r.l,Kt,ke,xe,Ye],styles:[""]}),e}(c.a),ao=o("Ktec"),no=[{path:"",redirectTo:"sales",pathMatch:"full"},{path:"sales",component:ro},{path:"stocks",component:wt}],co=function(){function t(){}return t.\u0275mod=i.Kb({type:t}),t.\u0275inj=i.Jb({factory:function(e){return new(e||t)},imports:[[r.c,j.e.forChild(no),a.c,ao.a,s.d,x.f,E.e,a.c,b.t,O.c,d.p,h.b,g.c,T.b,L.b,kt.b,I.m,A.b,Pt.b,Ft.e,Ft.g,jt.b,O.c,N.c,Bt.DashboardModule,I.t]]}),t}()}}]);