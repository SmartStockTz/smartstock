<mat-sidenav-container class="match-parent">

  <mat-sidenav-content>
    <app-toolbar [heading]="'Categories'"
                 [hasBackRoute]="true"
                 class="flex-grow-0"
                 [backLink]="'/stock'"
                 [showProgress]="false">
    </app-toolbar>

    <div *ngIf="!fetchCategoriesFlag">

      <div class="d-flex flex-row align-items-center">
        <h6 style="padding-left: 16px; margin: 0">Categories</h6>
        <span class="flex-grow-1"></span>
        <button style="padding-right: 16px" (click)="getCategories()" mat-icon-button color="primary">
          <mat-icon>refresh</mat-icon>
        </button>
      </div>

      <cdk-virtual-scroll-viewport itemSize="10" style="height: 100vh; width: 100vw">
        <mat-list>

          <div *cdkVirtualFor="let category of categories | async">
            <mat-divider></mat-divider>
            <mat-list-item>
              <div style="width: 40px; height: 40px; border-radius: 60px; background: #f5f5f5; color: black"
                   class="text-center"
                   matListIcon>
                {{category.name.substring(0, 1).toUpperCase()}}
              </div>
              <h1 matLine>{{category.name}}</h1>
              <span matLine>{{category.description}}</span>
              <button [matMenuTriggerData]="{category: category}" [matMenuTriggerFor]="menu" matSuffix mat-icon-button>
                <mat-icon>more_vert</mat-icon>
              </button>
            </mat-list-item>
          </div>

        </mat-list>
      </cdk-virtual-scroll-viewport>

    </div>

    <div *ngIf="fetchCategoriesFlag" style="height: 100vh; width: 100vw; position: fixed"
         class="d-flex justify-content-center align-items-center flex-column">
      <mat-progress-spinner matTooltip="fetch categories"
                            [diameter]="40" mode="indeterminate"
                            color="primary">
      </mat-progress-spinner>
      <span>Fetching categories</span>
    </div>

    <button style="position: fixed; bottom: 16px; right: 16px" (click)="openAddCategoryDialog()"
            color="primary"
            class="mat-fab ft-fab-position" mat-flat-button>
      <mat-icon>add</mat-icon>
    </button>

    <mat-menu #menu>
      <ng-template matMenuContent let-category="category">
        <!--            <button mat-menu-item (click)="showDetails(category)">View</button>-->
        <button mat-menu-item (click)="updateCategory(category)">Edit</button>
        <button mat-menu-item (click)="deleteCategory(category)">Delete</button>
      </ng-template>
    </mat-menu>

  </mat-sidenav-content>
</mat-sidenav-container>
